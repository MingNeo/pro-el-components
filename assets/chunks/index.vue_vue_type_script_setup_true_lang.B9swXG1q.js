import{a as q}from"./index.BxCfNOki.js";import{d as J}from"./dayjs.min.Ba62AOpW.js";import"./base.D1hT_OMg.js";import{y as Q,z as U,q as W,A as X,g as Z,h as ee,e as te}from"./pro-el-components.es.D2RWaTV6.js";import"./el-tag.eG6nSIS7.js";import"./el-select.DD745kxU.js";import"./el-scrollbar.D7CKjqK8.js";import"./el-popper.DVtARkBh.js";import"./el-input.BSgJ4dcH.js";import"./el-checkbox.vp91cqq1.js";import"./el-tooltip.l0sNRNKZ.js";import{_ as ae}from"./ColumnSetting.vue_vue_type_style_index_0_lang.BwUqYujD.js";import{defaultGetColumnKeys as se,getColumnKeys as re,getRenderProps as b,defaultSaveColumnKeys as oe}from"./helper.AYP33an4.js";import{d as le,p as B,h as v,s as ne,$ as ie,c as p,o as r,b as f,e as y,j as pe,k as i,G as de,ai as fe,B as S,w as u,r as g,a1 as H,aj as O,F as k,K as d,t as c,H as $,N as ye,a as P,n as ue,L as ce}from"./framework.CCndWvNN.js";const ge={key:0,class:"header-actions"},he=["href"],me=["src"],be={key:1},Me=le({name:"ProTable",inheritAttrs:!1,__name:"index",props:{tableId:{},columnSetting:{type:Boolean,default:void 0},autoHeight:{type:Boolean,default:void 0},class:{},format:{},columns:{},pagination:{},bottomOffset:{default:100},savedConfig:{},actions:{},title:{},data:{},size:{},width:{},height:{},maxHeight:{},fit:{type:Boolean},stripe:{type:Boolean},border:{type:Boolean},rowKey:{},context:{},showHeader:{type:Boolean},showSummary:{type:Boolean},sumText:{},summaryMethod:{},rowClassName:{},rowStyle:{},cellClassName:{},cellStyle:{},headerRowClassName:{},headerRowStyle:{},headerCellClassName:{},headerCellStyle:{},highlightCurrentRow:{type:Boolean},currentRowKey:{},emptyText:{},expandRowKeys:{},defaultExpandAll:{type:Boolean},defaultSort:{},tooltipEffect:{},tooltipOptions:{},spanMethod:{},selectOnIndeterminate:{type:Boolean},indent:{},treeProps:{},lazy:{type:Boolean},load:{},className:{},style:{},tableLayout:{},scrollbarAlwaysOn:{type:Boolean},flexible:{type:Boolean},showOverflowTooltip:{type:[Boolean,Object]},tooltipFormatter:{},appendFilterPanelTo:{},scrollbarTabindex:{}},setup(j){var K,m,w;const s=j,x=ce("isInListPageContent",!1),h=s.tableId||((K=window.location.pathname)==null?void 0:K.replace(/\//g,"_")),A=B(),C=B((((w=(m=s.savedConfig)==null?void 0:m.getColumnKeys)==null?void 0:w.call(m,h))??se(h))||[]),T=v(()=>C.value||re(s.columns)),L=v(()=>{const a=(s.columns||[]).map(o=>{var l,e,t;return{...o,width:o.width||(o.columnType==="actions"?150:void 0),mappingMap:o.renderAs==="enum"&&((e=(l=o.fieldProps)==null?void 0:l.options)!=null&&e.length)?Q((t=o.fieldProps)==null?void 0:t.options,"value"):{}}});if(s.columnSetting&&T.value.length){const o=a.filter(e=>e.columnType==="actions");return[...T.value.map(e=>e.visible?a.find(t=>t.prop===e.prop):null).filter(Boolean)||[],...o||[]]}return a}),D=v(()=>{var l;if(!s.pagination)return s.data;const{pageSize:a=10,currentPage:o=1}=s.pagination;return(l=s.data)==null?void 0:l.slice((o-1)*a,o*a)});function F(a){var e;C.value=a;const o=((e=s.savedConfig)==null?void 0:e.saveColumnKeys)??oe,l=a.every(t=>t.visible);o(h,a,l)}const I=B();ne(R),q(window,"resize",R);function R(){var a;(s.autoHeight??x)&&(I.value=window.innerHeight-(((a=A.value)==null?void 0:a.getBoundingClientRect().top)||0)-s.bottomOffset)}const V=ie(),Y=v(()=>Object.keys(V).filter(a=>a!=="default"));return(a,o)=>(r(),p("div",{class:ue(`pro-table ${s.class}`)},[s.title||s.actions?(r(),f(i(U),{key:0,title:s.title,size:"small",actions:s.actions,class:"table-header"},null,8,["title","actions"])):y("",!0),pe("div",{ref_key:"tableRef",ref:A,class:"pro-table-inner"},[de(i(ee),d({class:"pro-el-table",data:D.value},a.$attrs),fe({default:u(l=>[g(a.$slots,"default",H(O(l||{}))),(r(!0),p(k,null,S(L.value,e=>(r(),f(i(Z),d({key:e.prop,label:e.label,prop:e.prop,ref_for:!0},e),{header:u(({$index:t})=>[e.columnType==="actions"?(r(),p("div",ge,[P(c(e.label||"操作")+" ",1),a.columnSetting?(r(),f(ae,{key:0,columns:s.columns,"table-key":i(h),"saved-column-keys":C.value,onSave:F},null,8,["columns","table-key","saved-column-keys"])):y("",!0)])):e.type!=="selection"?g(a.$slots,"column-header",d({key:1,ref_for:!0},{column:e,$index:t})):y("",!0)]),default:u(({row:t,$index:_})=>[e.columnType==="actions"?(r(),f(i(W),d({key:0,ref_for:!0},e,{record:t,type:"link",index:_}),null,16,["record","index"])):e.type!=="selection"?g(a.$slots,"column-default",d({key:1,ref_for:!0},{$index:_,row:t,column:e}),()=>{var z,N,M,E;return[e.renderAs&&!e.customRender?(r(),p(k,{key:0},[e.renderAs==="file"?(r(),p("div",d({key:0,class:"file-links",ref_for:!0},i(b)(e.renderProps,t,e)),[(r(!0),p(k,null,S([t[e.prop]].flat(),(n,G)=>(r(),p("a",{key:G,target:"_blank",href:typeof n=="string"?n:n==null?void 0:n.url},c(typeof n=="string"?"附件":n==null?void 0:n.name),9,he))),128))],16)):e.renderAs==="image"?(r(),p("img",d({key:1,src:t[e.prop],alt:"",class:"table-image",ref_for:!0},i(b)(e.renderProps,t,e)),null,16,me)):e.renderAs==="date"?(r(),p("span",d({key:2,ref_for:!0},i(b)(e.renderProps,t,e)),c(t[e.prop]?i(J)(t[e.prop]).format(((z=e.fieldProps)==null?void 0:z.format)||"YYYY-MM-DD"):""),17)):e.renderAs&&typeof e.renderAs!="string"?(r(),f($(e.renderAs),d({key:3,ref_for:!0},{...t[e.prop],...i(b)(e.renderProps,t,e)}),null,16)):e.renderAs==="enum"?(r(),f($((N=e.mappingMap[t[e.prop]])!=null&&N.status?i(X):"div"),{key:4,status:(M=e.mappingMap[t[e.prop]])==null?void 0:M.status,style:ye((E=e.mappingMap[t[e.prop]])==null?void 0:E.style)},{default:u(()=>{var n;return[P(c(((n=e.mappingMap[t[e.prop]])==null?void 0:n.label)||t[e.prop]),1)]}),_:2},1032,["status","style"])):y("",!0)],64)):e.customRender?(r(),p("div",be,c(e.customRender(t,e,_)),1)):(r(),p(k,{key:2},[P(c(t[e.prop]),1)],64))]}):y("",!0)]),"filter-icon":u(()=>[g(a.$slots,"column-filter-icon")]),_:2},1040,["label","prop"]))),128))]),_:2},[S(Y.value,l=>({name:l,fn:u(e=>[g(a.$slots,l,H(O(e||{})))])}))]),1040,["data"]),s.pagination?(r(),f(i(te),d({key:0},s.pagination,{class:"pro-table-pagination"}),null,16)):y("",!0)],512)],2))}});export{Me as _};
