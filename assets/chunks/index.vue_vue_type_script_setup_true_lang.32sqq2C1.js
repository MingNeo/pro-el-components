import{u as pe,_ as $e,b as at,d as oe,w as nt}from"./base.Dwgz6jSd.js";/* empty css                          */import{E as Vt}from"./el-input.DQ30HcuH.js";import{u as _t,a as Pt,E as Ue}from"./el-popper.CZJRST1P.js";import{c as Re,t as je,E as We,C as Lt}from"./el-tag.BDcJ6G_i.js";import{E as Mt}from"./el-checkbox.B0vmRW9S.js";/* empty css                 */import{E as st}from"./el-scrollbar.HZhNcw01.js";import{d as re,ak as Dt,C as Z,c as B,o as v,e as X,b as z,G as Y,Z as ve,w as A,j as ce,n as I,F as ie,L as lt,h as m,B as me,a as Ze,t as se,r as de,p as _,a6 as It,ac as Xe,ao as De,ax as At,V as Bt,a7 as Ge,q as le,b3 as Ft,v as Be,P as ue,aU as zt,as as Ht,a2 as Ce,k as u,ad as xt,a3 as Ye,N as Ot,a9 as Kt,X as qt,b4 as Ut,K as Rt}from"./framework.igcgEEdr.js";import{a as jt,c as Wt}from"./index.D353ODTN.js";import{A as Zt,l as ot,f as it,k as Xt,a as Gt}from"./index.BQOwn3WU.js";import{E as ge}from"./icon.C3T6eoYR.js";import{b as Yt}from"./index.RVi9Xofb.js";import{u as rt,a as Jt,b as Qt}from"./index.BjB1lFfg.js";import{u as ea,c as ta}from"./use-form-common-props.BIymRJo1.js";import{g as Ie,c as aa,a as na}from"./types.DNi1ojkw.js";import{e as be}from"./isEqual.DkZuJHVE.js";import{b as sa,f as Ne,g as ct}from"./index.Brw29sq5.js";import{s as la}from"./scroll.DxJqq-ED.js";import{U as Ee,C as we}from"./event.BB_Ol6Sd.js";import{E as F}from"./aria.9SHySdGF.js";import{b as oa}from"./index.BI4o4ewH.js";import{c as ut}from"./cloneDeep.DdLfN6Fq.js";import{a as dt,o as ia}from"./index.mDR6Kexr.js";import{u as ra}from"./use-form-item.Daeosa58.js";import{a as ca}from"./index.BndPLsPe.js";import{d as ua}from"./error.Cq9Fpw4b.js";import{d as da}from"./debounce.BwFge-ki.js";var pa=1/0;function fa(e){var a=e==null?0:e.length;return a?oa(e,pa):[]}var ha=re({name:"NodeContent",setup(){return{ns:pe("cascader-node")}},render(){const{ns:e}=this,{node:a,panel:n}=this.$parent,{data:s,label:l}=a,{renderLabelFn:p}=n;return Dt("span",{class:e.e("label")},p?p({node:a,data:s}):l)}});const Fe=Symbol(),va=re({name:"ElCascaderNode",components:{ElCheckbox:Mt,ElRadio:Yt,NodeContent:ha,ElIcon:ge,Check:it,Loading:ot,ArrowRight:Zt},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:a}){const n=lt(Fe),s=pe("cascader-node"),l=m(()=>n.isHoverMenu),p=m(()=>n.config.multiple),r=m(()=>n.config.checkStrictly),g=m(()=>{var E;return(E=n.checkedNodes[0])==null?void 0:E.uid}),d=m(()=>e.node.isDisabled),b=m(()=>e.node.isLeaf),N=m(()=>r.value&&!b.value||!d.value),P=m(()=>G(n.expandingNode)),L=m(()=>r.value&&n.checkedNodes.some(G)),G=E=>{var D;const{level:j,uid:ne}=e.node;return((D=E==null?void 0:E.pathNodes[j-1])==null?void 0:D.uid)===ne},K=()=>{P.value||n.expandNode(e.node)},H=E=>{const{node:D}=e;E!==D.checked&&n.handleCheckChange(D,E)},f=()=>{n.lazyLoad(e.node,()=>{b.value||K()})},k=E=>{l.value&&(M(),!b.value&&a("expand",E))},M=()=>{const{node:E}=e;!N.value||E.loading||(E.loaded?K():f())},w=()=>{l.value&&!b.value||(b.value&&!d.value&&!r.value&&!p.value?T(!0):M())},x=E=>{r.value?(H(E),e.node.loaded&&K()):T(E)},T=E=>{e.node.loaded?(H(E),!r.value&&K()):f()};return{panel:n,isHoverMenu:l,multiple:p,checkStrictly:r,checkedNodeId:g,isDisabled:d,isLeaf:b,expandable:N,inExpandingPath:P,inCheckedPath:L,ns:s,handleHoverExpand:k,handleExpand:M,handleClick:w,handleCheck:T,handleSelectCheck:x}}});function ma(e,a,n,s,l,p){const r=Z("el-checkbox"),g=Z("el-radio"),d=Z("check"),b=Z("el-icon"),N=Z("node-content"),P=Z("loading"),L=Z("arrow-right");return v(),B("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?void 0:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:I([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[X(" prefix "),e.multiple?(v(),z(r,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:ve(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(v(),z(g,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:ve(()=>{},["stop"])},{default:A(()=>[X(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),ce("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(v(),z(b,{key:2,class:I(e.ns.e("prefix"))},{default:A(()=>[Y(d)]),_:1},8,["class"])):X("v-if",!0),X(" content "),Y(N),X(" postfix "),e.isLeaf?X("v-if",!0):(v(),B(ie,{key:3},[e.node.loading?(v(),z(b,{key:0,class:I([e.ns.is("loading"),e.ns.e("postfix")])},{default:A(()=>[Y(P)]),_:1},8,["class"])):(v(),z(b,{key:1,class:I(["arrow-right",e.ns.e("postfix")])},{default:A(()=>[Y(L)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var ga=$e(va,[["render",ma],["__file","node.vue"]]);const ba=re({name:"ElCascaderMenu",components:{Loading:ot,ElIcon:ge,ElScrollbar:st,ElCascaderNode:ga},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const a=It(),n=pe("cascader-menu"),{t:s}=rt(),l=ea();let p=null,r=null;const g=lt(Fe),d=_(null),b=m(()=>!e.nodes.length),N=m(()=>!g.initialLoaded),P=m(()=>`${l.value}-${e.index}`),L=f=>{p=f.target},G=f=>{if(!(!g.isHoverMenu||!p||!d.value))if(p.contains(f.target)){K();const k=a.vnode.el,{left:M}=k.getBoundingClientRect(),{offsetWidth:w,offsetHeight:x}=k,T=f.clientX-M,E=p.offsetTop,D=E+p.offsetHeight;d.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${T} ${E} L${w} 0 V${E} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${T} ${D} L${w} ${x} V${D} Z" />
        `}else r||(r=window.setTimeout(H,g.config.hoverThreshold))},K=()=>{r&&(clearTimeout(r),r=null)},H=()=>{d.value&&(d.value.innerHTML="",K())};return{ns:n,panel:g,hoverZone:d,isEmpty:b,isLoading:N,menuId:P,t:s,handleExpand:L,handleMouseMove:G,clearHoverZone:H}}});function ya(e,a,n,s,l,p){const r=Z("el-cascader-node"),g=Z("loading"),d=Z("el-icon"),b=Z("el-scrollbar");return v(),z(b,{key:e.menuId,tag:"ul",role:"menu",class:I(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:A(()=>{var N;return[(v(!0),B(ie,null,me(e.nodes,P=>(v(),z(r,{key:P.uid,node:P,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(v(),B("div",{key:0,class:I(e.ns.e("empty-text"))},[Y(d,{size:"14",class:I(e.ns.is("loading"))},{default:A(()=>[Y(g)]),_:1},8,["class"]),Ze(" "+se(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(v(),B("div",{key:1,class:I(e.ns.e("empty-text"))},[de(e.$slots,"empty",{},()=>[Ze(se(e.t("el.cascader.noData")),1)])],2)):(N=e.panel)!=null&&N.isHoverMenu?(v(),B(ie,{key:2},[X(" eslint-disable-next-line vue/html-self-closing "),(v(),B("svg",{ref:"hoverZone",class:I(e.ns.e("hover-zone"))},null,2))],2112)):X("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var ka=$e(ba,[["render",ya],["__file","menu.vue"]]);let Ca=0;const Na=e=>{const a=[e];let{parent:n}=e;for(;n;)a.unshift(n),n=n.parent;return a};class fe{constructor(a,n,s,l=!1){this.data=a,this.config=n,this.parent=s,this.root=l,this.uid=Ca++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:p,label:r,children:g}=n,d=a[g],b=Na(this);this.level=l?0:s?s.level+1:1,this.value=a[p],this.label=a[r],this.pathNodes=b,this.pathValues=b.map(N=>N.value),this.pathLabels=b.map(N=>N.label),this.childrenData=d,this.children=(d||[]).map(N=>new fe(N,n,this)),this.loaded=!n.lazy||this.isLeaf||!Ie(d)}get isDisabled(){const{data:a,parent:n,config:s}=this,{disabled:l,checkStrictly:p}=s;return(Xe(l)?l(a,this):!!a[l])||!p&&(n==null?void 0:n.isDisabled)}get isLeaf(){const{data:a,config:n,childrenData:s,loaded:l}=this,{lazy:p,leaf:r}=n,g=Xe(r)?r(a,this):a[r];return aa(g)?p&&!l?!1:!(De(s)&&s.length):!!g}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(a){const{childrenData:n,children:s}=this,l=new fe(a,this.config,this);return De(n)?n.push(a):this.childrenData=[a],s.push(l),l}calcText(a,n){const s=a?this.pathLabels.join(n):this.label;return this.text=s,s}broadcast(a,...n){const s=`onParent${Re(a)}`;this.children.forEach(l=>{l&&(l.broadcast(a,...n),l[s]&&l[s](...n))})}emit(a,...n){const{parent:s}=this,l=`onChild${Re(a)}`;s&&(s[l]&&s[l](...n),s.emit(a,...n))}onParentCheck(a){this.isDisabled||this.setCheckState(a)}onChildCheck(){const{children:a}=this,n=a.filter(l=>!l.isDisabled),s=n.length?n.every(l=>l.checked):!1;this.setCheckState(s)}setCheckState(a){const n=this.children.length,s=this.children.reduce((l,p)=>{const r=p.checked?1:p.indeterminate?.5:0;return l+r},0);this.checked=this.loaded&&this.children.filter(l=>!l.isDisabled).every(l=>l.loaded&&l.checked)&&a,this.indeterminate=this.loaded&&s!==n&&s>0}doCheck(a){if(this.checked===a)return;const{checkStrictly:n,multiple:s}=this.config;n||!s?this.checked=a:(this.broadcast("check",a),this.setCheckState(a),this.emit("check"))}}const Ae=(e,a)=>e.reduce((n,s)=>(s.isLeaf?n.push(s):(!a&&n.push(s),n=n.concat(Ae(s.children,a))),n),[]);class Je{constructor(a,n){this.config=n;const s=(a||[]).map(l=>new fe(l,this.config));this.nodes=s,this.allNodes=Ae(s,!1),this.leafNodes=Ae(s,!0)}getNodes(){return this.nodes}getFlattedNodes(a){return a?this.leafNodes:this.allNodes}appendNode(a,n){const s=n?n.appendChild(a):new fe(a,this.config);n||this.nodes.push(s),this.appendAllNodesAndLeafNodes(s)}appendNodes(a,n){a.forEach(s=>this.appendNode(s,n))}appendAllNodesAndLeafNodes(a){this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a),a.children&&a.children.forEach(n=>{this.appendAllNodesAndLeafNodes(n)})}getNodeByValue(a,n=!1){return!a&&a!==0?null:this.getFlattedNodes(n).find(l=>be(l.value,a)||be(l.pathValues,a))||null}getSameNode(a){return a&&this.getFlattedNodes(!1).find(({value:s,level:l})=>be(a.value,s)&&a.level===l)||null}}const pt=at({modelValue:{type:oe([Number,String,Array])},options:{type:oe(Array),default:()=>[]},props:{type:oe(Object),default:()=>({})}}),Ea={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:At,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},wa=e=>m(()=>({...Ea,...e.props})),Qe=e=>{if(!e)return 0;const a=e.id.split("-");return Number(a[a.length-2])},$a=e=>{if(!e)return;const a=e.querySelector("input");a?a.click():sa(e)&&e.click()},Sa=(e,a)=>{const n=a.slice(0),s=n.map(p=>p.uid),l=e.reduce((p,r)=>{const g=s.indexOf(r.uid);return g>-1&&(p.push(r),n.splice(g,1),s.splice(g,1)),p},[]);return l.push(...n),l},et=e=>[...new Set(e)],tt=e=>!e&&e!==0?[]:De(e)?e:[e],Ta=re({name:"ElCascaderPanel",components:{ElCascaderMenu:ka},props:{...pt,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Ee,we,"close","expand-change"],setup(e,{emit:a,slots:n}){let s=!1;const l=pe("cascader"),p=wa(e);let r=null;const g=_(!0),d=_([]),b=_(null),N=_([]),P=_(null),L=_([]),G=m(()=>p.value.expandTrigger==="hover"),K=m(()=>e.renderLabel||n.default),H=()=>{const{options:c}=e,h=p.value;s=!1,r=new Je(c,h),N.value=[r.getNodes()],h.lazy&&Ie(e.options)?(g.value=!1,f(void 0,C=>{C&&(r=new Je(C,h),N.value=[r.getNodes()]),g.value=!0,j(!1,!0)})):j(!1,!0)},f=(c,h)=>{const C=p.value;c=c||new fe({},C,void 0,!0),c.loading=!0;const y=$=>{const V=c,q=V.root?null:V;$&&(r==null||r.appendNodes($,q)),V.loading=!1,V.loaded=!0,V.childrenData=V.childrenData||[],h&&h($)};C.lazyLoad(c,y)},k=(c,h)=>{var C;const{level:y}=c,$=N.value.slice(0,y);let V;c.isLeaf?V=c.pathNodes[y-2]:(V=c,$.push(c.children)),((C=P.value)==null?void 0:C.uid)!==(V==null?void 0:V.uid)&&(P.value=c,N.value=$,!h&&a("expand-change",(c==null?void 0:c.pathValues)||[]))},M=(c,h,C=!0)=>{const{checkStrictly:y,multiple:$}=p.value,V=L.value[0];s=!0,!$&&(V==null||V.doCheck(!1)),c.doCheck(h),D(),C&&!$&&!y&&a("close"),!C&&!$&&!y&&w(c)},w=c=>{c&&(c=c.parent,w(c),c&&k(c))},x=c=>r==null?void 0:r.getFlattedNodes(c),T=c=>{var h;return(h=x(c))==null?void 0:h.filter(C=>C.checked!==!1)},E=()=>{L.value.forEach(c=>c.doCheck(!1)),D(),N.value=N.value.slice(0,1),P.value=null,a("expand-change",[])},D=()=>{var c;const{checkStrictly:h,multiple:C}=p.value,y=L.value,$=T(!h),V=Sa(y,$),q=V.map(O=>O.valueByOption);L.value=V,b.value=C?q:(c=q[0])!=null?c:null},j=(c=!1,h=!1)=>{const{modelValue:C}=e,{lazy:y,multiple:$,checkStrictly:V}=p.value,q=!V;if(!(!g.value||s||!h&&be(C,b.value)))if(y&&!c){const U=et(fa(tt(C))).map(W=>r==null?void 0:r.getNodeByValue(W)).filter(W=>!!W&&!W.loaded&&!W.loading);U.length?U.forEach(W=>{f(W,()=>j(!1,h))}):j(!0,h)}else{const O=$?tt(C):[C],U=et(O.map(W=>r==null?void 0:r.getNodeByValue(W,q)));ne(U,h),b.value=ut(C)}},ne=(c,h=!0)=>{const{checkStrictly:C}=p.value,y=L.value,$=c.filter(O=>!!O&&(C||O.isLeaf)),V=r==null?void 0:r.getSameNode(P.value),q=h&&V||$[0];q?q.pathNodes.forEach(O=>k(O,!0)):P.value=null,y.forEach(O=>O.doCheck(!1)),Ge($).forEach(O=>O.doCheck(!0)),L.value=$,ue(J)},J=()=>{dt&&d.value.forEach(c=>{const h=c==null?void 0:c.$el;if(h){const C=h.querySelector(`.${l.namespace.value}-scrollbar__wrap`),y=h.querySelector(`.${l.b("node")}.${l.is("active")}`)||h.querySelector(`.${l.b("node")}.in-active-path`);la(C,y)}})},ee=c=>{const h=c.target,{code:C}=c;switch(C){case F.up:case F.down:{c.preventDefault();const y=C===F.up?-1:1;Ne(ct(h,y,`.${l.b("node")}[tabindex="-1"]`));break}case F.left:{c.preventDefault();const y=d.value[Qe(h)-1],$=y==null?void 0:y.$el.querySelector(`.${l.b("node")}[aria-expanded="true"]`);Ne($);break}case F.right:{c.preventDefault();const y=d.value[Qe(h)+1],$=y==null?void 0:y.$el.querySelector(`.${l.b("node")}[tabindex="-1"]`);Ne($);break}case F.enter:case F.numpadEnter:$a(h);break}};return Bt(Fe,Ge({config:p,expandingNode:P,checkedNodes:L,isHoverMenu:G,initialLoaded:g,renderLabelFn:K,lazyLoad:f,expandNode:k,handleCheckChange:M})),le([p,()=>e.options],H,{deep:!0,immediate:!0}),le(()=>e.modelValue,()=>{s=!1,j()},{deep:!0}),le(()=>b.value,c=>{be(c,e.modelValue)||(a(Ee,c),a(we,c))}),Ft(()=>d.value=[]),Be(()=>!Ie(e.modelValue)&&j()),{ns:l,menuList:d,menus:N,checkedNodes:L,handleKeyDown:ee,handleCheckChange:M,getFlattedNodes:x,getCheckedNodes:T,clearCheckedNodes:E,calculateCheckedValue:D,scrollToExpandingNode:J}}});function Va(e,a,n,s,l,p){const r=Z("el-cascader-menu");return v(),B("div",{class:I([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(v(!0),B(ie,null,me(e.menus,(g,d)=>(v(),z(r,{key:d,ref_for:!0,ref:b=>e.menuList[d]=b,index:d,nodes:[...g]},{empty:A(()=>[de(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var _a=$e(Ta,[["render",Va],["__file","index.vue"]]);const Pa=nt(_a),La=at({...pt,size:ia,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:oe(Function),default:(e,a)=>e.text.includes(a)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:oe(Function),default:()=>!0},placement:{type:oe(String),values:Pt,default:"bottom-start"},fallbackPlacements:{type:oe(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:_t.teleported,tagType:{...je.type,default:"info"},tagEffect:{...je.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Jt}),Ma={[Ee]:e=>!0,[we]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>na(e),expandChange:e=>!!e,removeTag:e=>!!e},Da="ElCascader",Ia=re({name:Da}),Aa=re({...Ia,props:La,emits:Ma,setup(e,{expose:a,emit:n}){const s=e,l={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:t})=>{const{modifiersData:o,placement:i}=t;["right","left","bottom","top"].includes(i)||(o.arrow.x=35)},requires:["arrow"]}]},p=zt();let r=0,g=0;const d=pe("cascader"),b=pe("input"),{t:N}=rt(),{form:P,formItem:L}=ra(),{valueOnClear:G}=Qt(s),{isComposing:K,handleComposition:H}=ca({afterComposition(t){var o;const i=(o=t.target)==null?void 0:o.value;Me(i)}}),f=_(null),k=_(null),M=_(null),w=_(null),x=_(null),T=_(!1),E=_(!1),D=_(!1),j=_(!1),ne=_(""),J=_(""),ee=_([]),c=_([]),h=_([]),C=m(()=>p.style),y=m(()=>s.disabled||(P==null?void 0:P.disabled)),$=m(()=>s.placeholder||N("el.cascader.placeholder")),V=m(()=>J.value||ee.value.length>0||K.value?"":$.value),q=ta(),O=m(()=>q.value==="small"?"small":"default"),U=m(()=>!!s.props.multiple),W=m(()=>!s.filterable||U.value),ze=m(()=>U.value?J.value:ne.value),ye=m(()=>{var t;return((t=w.value)==null?void 0:t.checkedNodes)||[]}),ft=m(()=>!s.clearable||y.value||D.value||!E.value?!1:!!ye.value.length),ke=m(()=>{const{showAllLevels:t,separator:o}=s,i=ye.value;return i.length?U.value?"":i[0].calcText(t,o):""}),ht=m(()=>(L==null?void 0:L.validateState)||""),Se=m({get(){return ut(s.modelValue)},set(t){const o=t??G.value;n(Ee,o),n(we,o),s.validateEvent&&(L==null||L.validate("change").catch(i=>ua()))}}),vt=m(()=>[d.b(),d.m(q.value),d.is("disabled",y.value),p.class]),mt=m(()=>[b.e("icon"),"icon-arrow-down",d.is("reverse",T.value)]),gt=m(()=>d.is("focus",T.value||j.value)),He=m(()=>{var t,o;return(o=(t=f.value)==null?void 0:t.popperRef)==null?void 0:o.contentRef}),R=t=>{var o,i,S;y.value||(t=t??!T.value,t!==T.value&&(T.value=t,(i=(o=k.value)==null?void 0:o.input)==null||i.setAttribute("aria-expanded",`${t}`),t?(he(),ue((S=w.value)==null?void 0:S.scrollToExpandingNode)):s.filterable&&Le(),n("visibleChange",t)))},he=()=>{ue(()=>{var t;(t=f.value)==null||t.updatePopper()})},Te=()=>{D.value=!1},Ve=t=>{const{showAllLevels:o,separator:i}=s;return{node:t,key:t.uid,text:t.calcText(o,i),hitState:!1,closable:!y.value&&!t.isDisabled,isCollapseTag:!1}},_e=t=>{var o;const i=t.node;i.doCheck(!1),(o=w.value)==null||o.calculateCheckedValue(),n("removeTag",i.valueByOption)},bt=()=>{if(!U.value)return;const t=ye.value,o=[],i=[];if(t.forEach(S=>i.push(Ve(S))),c.value=i,t.length){t.slice(0,s.maxCollapseTags).forEach(Q=>o.push(Ve(Q)));const S=t.slice(s.maxCollapseTags),te=S.length;te&&(s.collapseTags?o.push({key:-1,text:`+ ${te}`,closable:!1,isCollapseTag:!0}):S.forEach(Q=>o.push(Ve(Q))))}ee.value=o},xe=()=>{var t,o;const{filterMethod:i,showAllLevels:S,separator:te}=s,Q=(o=(t=w.value)==null?void 0:t.getFlattedNodes(!s.props.checkStrictly))==null?void 0:o.filter(ae=>ae.isDisabled?!1:(ae.calcText(S,te),i(ae,ze.value)));U.value&&(ee.value.forEach(ae=>{ae.hitState=!1}),c.value.forEach(ae=>{ae.hitState=!1})),D.value=!0,h.value=Q,he()},yt=()=>{var t;let o;D.value&&x.value?o=x.value.$el.querySelector(`.${d.e("suggestion-item")}`):o=(t=w.value)==null?void 0:t.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`),o&&(o.focus(),!D.value&&o.click())},Pe=()=>{var t,o;const i=(t=k.value)==null?void 0:t.input,S=M.value,te=(o=x.value)==null?void 0:o.$el;if(!(!dt||!i)){if(te){const Q=te.querySelector(`.${d.e("suggestion-list")}`);Q.style.minWidth=`${i.offsetWidth}px`}if(S){const{offsetHeight:Q}=S,ae=ee.value.length>0?`${Math.max(Q,r)-2}px`:`${r}px`;i.style.height=ae,he()}}},kt=t=>{var o;return(o=w.value)==null?void 0:o.getCheckedNodes(t)},Ct=t=>{he(),n("expandChange",t)},Nt=t=>{if(!K.value)switch(t.code){case F.enter:case F.numpadEnter:R();break;case F.down:R(!0),ue(yt),t.preventDefault();break;case F.esc:T.value===!0&&(t.preventDefault(),t.stopPropagation(),R(!1));break;case F.tab:R(!1);break}},Et=()=>{var t;(t=w.value)==null||t.clearCheckedNodes(),!T.value&&s.filterable&&Le(),R(!1),n("clear")},Le=()=>{const{value:t}=ke;ne.value=t,J.value=t},wt=t=>{var o,i;const{checked:S}=t;U.value?(o=w.value)==null||o.handleCheckChange(t,!S,!1):(!S&&((i=w.value)==null||i.handleCheckChange(t,!0,!1)),R(!1))},$t=t=>{const o=t.target,{code:i}=t;switch(i){case F.up:case F.down:{t.preventDefault();const S=i===F.up?-1:1;Ne(ct(o,S,`.${d.e("suggestion-item")}[tabindex="-1"]`));break}case F.enter:case F.numpadEnter:o.click();break}},St=()=>{const t=ee.value,o=t[t.length-1];g=J.value?0:g+1,!(!o||!g||s.collapseTags&&t.length>1)&&(o.hitState?_e(o):o.hitState=!0)},Oe=t=>{const o=t.target,i=d.e("search-input");o.className===i&&(j.value=!0),n("focus",t)},Ke=t=>{j.value=!1,n("blur",t)},Tt=da(()=>{const{value:t}=ze;if(!t)return;const o=s.beforeFilter(t);Ht(o)?o.then(xe).catch(()=>{}):o!==!1?xe():Te()},s.debounce),Me=(t,o)=>{!T.value&&R(!0),!(o!=null&&o.isComposing)&&(t?Tt():Te())},qe=t=>Number.parseFloat(Wt(b.cssVarName("input-height"),t).value)-2;return le(D,he),le([ye,y,()=>s.collapseTags],bt),le(ee,()=>{ue(()=>Pe())}),le(q,async()=>{await ue();const t=k.value.input;r=qe(t)||r,Pe()}),le(ke,Le,{immediate:!0}),Be(()=>{const t=k.value.input,o=qe(t);r=t.offsetHeight||o,jt(t,Pe)}),a({getCheckedNodes:kt,cascaderPanelRef:w,togglePopperVisible:R,contentRef:He,presentText:ke}),(t,o)=>(v(),z(u(Ue),{ref_key:"tooltipRef",ref:f,visible:T.value,teleported:t.teleported,"popper-class":[u(d).e("dropdown"),t.popperClass],"popper-options":l,"fallback-placements":t.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:t.placement,transition:`${u(d).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:t.persistent,onHide:Te},{default:A(()=>[Ce((v(),B("div",{class:I(u(vt)),style:Ot(u(C)),onClick:()=>R(u(W)?void 0:!0),onKeydown:Nt,onMouseenter:i=>E.value=!0,onMouseleave:i=>E.value=!1},[Y(u(Vt),{ref_key:"input",ref:k,modelValue:ne.value,"onUpdate:modelValue":i=>ne.value=i,placeholder:u(V),readonly:u(W),disabled:u(y),"validate-event":!1,size:u(q),class:I(u(gt)),tabindex:u(U)&&t.filterable&&!u(y)?-1:void 0,onCompositionstart:u(H),onCompositionupdate:u(H),onCompositionend:u(H),onFocus:Oe,onBlur:Ke,onInput:Me},Kt({suffix:A(()=>[u(ft)?(v(),z(u(ge),{key:"clear",class:I([u(b).e("icon"),"icon-circle-close"]),onClick:ve(Et,["stop"])},{default:A(()=>[Y(u(Xt))]),_:1},8,["class","onClick"])):(v(),z(u(ge),{key:"arrow-down",class:I(u(mt)),onClick:ve(i=>R(),["stop"])},{default:A(()=>[Y(u(Gt))]),_:1},8,["class","onClick"]))]),_:2},[t.$slots.prefix?{name:"prefix",fn:A(()=>[de(t.$slots,"prefix")])}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),u(U)?(v(),B("div",{key:0,ref_key:"tagWrapper",ref:M,class:I([u(d).e("tags"),u(d).is("validate",!!u(ht))])},[(v(!0),B(ie,null,me(ee.value,i=>(v(),z(u(We),{key:i.key,type:t.tagType,size:u(O),effect:t.tagEffect,hit:i.hitState,closable:i.closable,"disable-transitions":"",onClose:S=>_e(i)},{default:A(()=>[i.isCollapseTag===!1?(v(),B("span",{key:0},se(i.text),1)):(v(),z(u(Ue),{key:1,disabled:T.value||!t.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:A(()=>[ce("span",null,se(i.text),1)]),content:A(()=>[ce("div",{class:I(u(d).e("collapse-tags"))},[(v(!0),B(ie,null,me(c.value.slice(t.maxCollapseTags),(S,te)=>(v(),B("div",{key:te,class:I(u(d).e("collapse-tag"))},[(v(),z(u(We),{key:S.key,class:"in-tooltip",type:t.tagType,size:u(O),effect:t.tagEffect,hit:S.hitState,closable:S.closable,"disable-transitions":"",onClose:Q=>_e(S)},{default:A(()=>[ce("span",null,se(S.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),t.filterable&&!u(y)?Ce((v(),B("input",{key:0,"onUpdate:modelValue":i=>J.value=i,type:"text",class:I(u(d).e("search-input")),placeholder:u(ke)?"":u($),onInput:i=>Me(J.value,i),onClick:ve(i=>R(!0),["stop"]),onKeydown:qt(St,["delete"]),onCompositionstart:u(H),onCompositionupdate:u(H),onCompositionend:u(H),onFocus:Oe,onBlur:Ke},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[Ut,J.value]]):X("v-if",!0)],2)):X("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[u(Lt),()=>R(!1),u(He)]])]),content:A(()=>[Ce(Y(u(Pa),{ref_key:"cascaderPanelRef",ref:w,modelValue:u(Se),"onUpdate:modelValue":i=>xt(Se)?Se.value=i:null,options:t.options,props:s.props,border:!1,"render-label":t.$slots.default,onExpandChange:Ct,onClose:i=>t.$nextTick(()=>R(!1))},{empty:A(()=>[de(t.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[Ye,!D.value]]),t.filterable?Ce((v(),z(u(st),{key:0,ref_key:"suggestionPanel",ref:x,tag:"ul",class:I(u(d).e("suggestion-panel")),"view-class":u(d).e("suggestion-list"),onKeydown:$t},{default:A(()=>[h.value.length?(v(!0),B(ie,{key:0},me(h.value,i=>(v(),B("li",{key:i.uid,class:I([u(d).e("suggestion-item"),u(d).is("checked",i.checked)]),tabindex:-1,onClick:S=>wt(i)},[de(t.$slots,"suggestion-item",{item:i},()=>[ce("span",null,se(i.text),1),i.checked?(v(),z(u(ge),{key:0},{default:A(()=>[Y(u(it))]),_:1})):X("v-if",!0)])],10,["onClick"]))),128)):de(t.$slots,"empty",{key:1},()=>[ce("li",{class:I(u(d).e("empty-text"))},se(u(N)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Ye,D.value]]):X("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var Ba=$e(Aa,[["__file","cascader.vue"]]);const Fa=nt(Ba),za={key:0},hn=re({name:"ProCascader",inheritAttrs:!1,__name:"index",props:{modelValue:{},service:{},viewMode:{type:Boolean},props:{default:()=>({})},options:{default:()=>[]}},emits:["update:modelValue","change"],setup(e,{emit:a}){const n=e,s=a,{label:l="label",value:p="value",children:r="children",multiple:g}=n.props,d=_([]),b=m(()=>[...n.options,...d.value]);function N(f){return Array.isArray(f)?f[f.length-1]:f}function P(f){const k=g?f.map(N):N(f);s("update:modelValue",k),s("change",k,f)}async function L(){var f;try{const k=await((f=n.service)==null?void 0:f.call(n))??[];d.value=G(k)}catch(k){console.error("加载级联选择器数据失败:",k)}}function G(f){return f.map(k=>{const M={...k,[p]:String(k[p])};return k[r]&&(M[r]=G(k[r])),M})}function K(f,k,M=[]){for(const w of f){const x=[...M,w];if(String(w[p])===String(k))return x;if(w[r]){const T=K(w[r],k,x);if(T)return T}}return null}function H(f){return(Array.isArray(f)?f:[f].filter(Boolean)).map(M=>{if(!M)return"-无-";const w=K(b.value,String(M));return w?w.map(x=>x[l]).join("-"):"-无-"}).filter(M=>M!=="-无-")}return Be(L),(f,k)=>f.viewMode?(v(),B("span",za,se(H(f.modelValue).join(", ")||"-无-"),1)):(v(),z(u(Fa),Rt({key:1},f.$attrs,{"model-value":f.modelValue,options:b.value,props:n.props,"dropdown-class-name":"pro-cascader-dropdown",onChange:P}),null,16,["model-value","options","props"]))}});export{Fa as E,hn as _,tt as c};
