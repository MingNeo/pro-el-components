import{o as B}from"./index.CacP4YLb.js";import"./base.BdmgHdsK.js";import{E as g}from"./el-checkbox.BNYvkwwK.js";import"./el-button.DE4WLPFu.js";import{b as K}from"./el-dropdown.DSgujdVA.js";import"./el-popper.BuQPBkTD.js";import"./el-scrollbar.DH4X1zpC.js";import{getColumnKeys as N}from"./helper.AYP33an4.js";import{E as S}from"./index.RKxNzSBd.js";import{d as A,p as d,h as v,s as D,b as F,o as p,k as n,w as a,G as r,n as I,j as i,c as C,F as R,B as T,a as b,t as j}from"./framework.C7SOrqHQ.js";const z={class:"column-setting-content"},G={class:"column-setting-footer"},W=A({__name:"ColumnSetting",props:{tableKey:{},columns:{},savedColumnKeys:{}},emits:["save"],setup(h,{emit:k}){const u=h,y=k,m=d(),c=d(!1),f=v(()=>u.savedColumnKeys||N(u.columns)),s=d([]),_=v(()=>{const l=s.value.filter(e=>e.visible);return l.length>0&&l.length<s.value.length}),w=v(()=>s.value.every(l=>l.visible));D(()=>{s.value=u.columns.filter(l=>l.columnType!=="actions").map(l=>{var e,o;return{...l,visible:(e=f.value)!=null&&e.length?(o=f.value.find(t=>t.prop===l.prop))==null?void 0:o.visible:!0}})});function E(l,e){const o=s.value.find(t=>t.prop===l);o&&(o.visible=e)}function V(l){s.value.forEach(e=>{e.visible=l})}function x(){var l;y("save",s.value.map(({prop:e,visible:o})=>({prop:e,visible:o}))),(l=m.value)==null||l.handleClose()}return(l,e)=>(p(),F(n(K),{ref_key:"dropdownRef",ref:m,modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=o=>c.value=o),class:"pro-column-setting",trigger:"click"},{dropdown:a(()=>[i("div",z,[(p(!0),C(R,null,T(s.value,o=>(p(),C("div",{key:o.prop,class:"column-setting-item"},[r(n(g),{"model-value":o.visible,onChange:t=>E(o.prop,!!t)},{default:a(()=>[b(j(o.label),1)]),_:2},1032,["model-value","onChange"])]))),128)),i("div",G,[r(n(g),{"model-value":w.value,indeterminate:_.value,onChange:e[0]||(e[0]=o=>V(o))},{default:a(()=>e[3]||(e[3]=[b(" 全选 ")])),_:1},8,["model-value","indeterminate"]),i("div",null,[i("span",{class:"cancel-btn",onClick:e[1]||(e[1]=o=>{var t;return(t=m.value)==null?void 0:t.handleClose()})},"取消"),i("a",{class:"confirm-btn",onClick:x},"确定")])])])]),default:a(()=>[r(n(S),{class:I(["column-setting-icon",{active:c.value}])},{default:a(()=>[r(n(B))]),_:1},8,["class"])]),_:1},8,["modelValue"]))}});export{W as _};
