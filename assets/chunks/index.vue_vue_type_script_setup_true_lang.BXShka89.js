import{m as M}from"./index.l2C8AFQu.js";import"./base.D1hT_OMg.js";import{E as V}from"./el-button.Ks_KV28J.js";import{E as I,a as A,b as j}from"./el-dropdown.BOifsY6J.js";import"./el-popper.DVtARkBh.js";import"./el-scrollbar.D7CKjqK8.js";import"./el-dropdown-item.l0sNRNKZ.js";import{E as G}from"./el-popover.D2JF-F-v.js";import{_ as H}from"./Action.vue_vue_type_script_setup_true_lang.Dpx7dNUG.js";import{E as D}from"./index.dVC2hAAQ.js";import{d as K,h as i,$ as L,c,o as l,b as n,e as B,F as p,B as v,K as N,w as r,G as k,a as w,t as h,H as b,k as a,n as x,j as O}from"./framework.CCndWvNN.js";const Y=["link"],te=K({name:"ProButtonActions",__name:"index",props:{actions:{type:[Array,Function],default:()=>[]},record:{},column:{},index:{},hasPermission:{type:Function,default:()=>!0},moreDropdownProps:{},maxCount:{default:Number.POSITIVE_INFINITY},moreText:{default:""},moreIcon:{},slotPriority:{type:Boolean,default:!1},type:{},size:{default:"small"}},setup(S){const e=S,u=i(()=>((typeof e.actions=="function"?e.actions(e.record,e.column,e.index):e.actions)||[]).filter(s=>s&&(typeof s.show=="function"?s.show(e.record,e.column,e.index):s.show??!0)&&(!s.permission||e.hasPermission(s.permission))).map(s=>({...s,link:s.link??e.type==="link",disabled:typeof s.disabled=="function"?s.disabled(e.record,e.column,e.index):s.disabled}))),y=L(),m=i(()=>{var t;return((t=y.default)==null?void 0:t.call(y))||[]}),_=i(()=>u.value.length+m.value.length>e.maxCount),f=i(()=>{const t=e.slotPriority??!1;if(!_.value)return{visibleItems:{actions:u.value,slots:m.value},dropdownItems:{actions:[],slots:[]}};if(t){const s=Math.max(0,e.maxCount-m.value.length);return{visibleItems:{slots:m.value.slice(0,e.maxCount),actions:u.value.slice(0,s)},dropdownItems:{slots:m.value.slice(e.maxCount),actions:u.value.slice(s)}}}else{const s=Math.max(0,e.maxCount-u.value.length);return{visibleItems:{actions:u.value.slice(0,e.maxCount),slots:m.value.slice(0,s)},dropdownItems:{actions:u.value.slice(e.maxCount),slots:m.value.slice(s)}}}}),$=i(()=>f.value.visibleItems.actions),z=i(()=>f.value.visibleItems.slots),T=i(()=>f.value.dropdownItems.actions),F=i(()=>f.value.dropdownItems.slots);function C(t){t.onClick(e.record,e.column,e.index)}return(t,s)=>{var g,P;return l(),c("div",{class:x(["pro-button-actions",{"is-link":t.type==="link"}])},[(l(!0),c(p,null,v($.value,(o,d)=>(l(),n(H,N({key:d,ref_for:!0},o,{size:t.size??o.size,onClick:E=>C(o)}),null,16,["size","onClick"]))),128)),(l(!0),c(p,null,v(z.value,(o,d)=>(l(),n(b(o),{key:`slot-${d}`}))),128)),_.value?(l(),n(a(j),N({key:0},t.moreDropdownProps,{placement:((g=t.moreDropdownProps)==null?void 0:g.placement)||"bottom",teleported:((P=t.moreDropdownProps)==null?void 0:P.teleported)??!0,trigger:"click","hide-on-click":!1}),{dropdown:r(()=>[k(a(A),null,{default:r(()=>[(l(!0),c(p,null,v(T.value,(o,d)=>(l(),c(p,{key:d},[o.confirm?(l(),n(a(I),{key:1,disabled:o.disabled,class:x(["dropdown-item-confirm",{"danger-item":o.type==="danger"}])},{default:r(()=>[k(a(G),{disabled:o.disabled,title:o.confirmText||"确认?","confirm-button-text":"是","cancel-button-text":"否",onConfirm:E=>C(o)},{reference:r(()=>[O("div",{class:"confirm-content",link:o.link??t.type==="link"},[o.icon?(l(),n(a(D),{key:0},{default:r(()=>[(l(),n(b(o.icon)))]),_:2},1024)):B("",!0),w(" "+h(o.text),1)],8,Y)]),_:2},1032,["disabled","title","onConfirm"])]),_:2},1032,["disabled","class"])):(l(),n(a(I),{key:0,icon:o.icon,disabled:o.disabled,class:x({"danger-item":o.type==="danger"}),onClick:E=>C(o)},{default:r(()=>[w(h(o.text),1)]),_:2},1032,["icon","disabled","class","onClick"]))],64))),128)),(l(!0),c(p,null,v(F.value,(o,d)=>(l(),n(a(I),{key:`slot-${d}`},{default:r(()=>[(l(),n(b(o)))]),_:2},1024))),128))]),_:1})]),default:r(()=>[k(a(V),{link:"",class:"more-action"},{default:r(()=>[w(h(t.moreText)+" ",1),t.moreIcon?(l(),n(b(t.moreIcon),{key:0})):(l(),n(a(D),{key:1},{default:r(()=>[k(a(M),{class:"more-icon"})]),_:1}))]),_:1})]),_:1},16,["placement","teleported"])):B("",!0)],2)}}});export{te as _};
