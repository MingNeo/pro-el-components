import"./base.BdmgHdsK.js";import{E as v}from"./el-button.DE4WLPFu.js";import{E as w}from"./el-checkbox.BNYvkwwK.js";import{Y as F,b as d,a as N}from"./pro-el-components.es.BbdLL6xm.js";import{E as C}from"./el-input.CeBPwPDU.js";/* empty css                   */import{E as V}from"./index.WZ0sw04i.js";import{d as S,a8 as B,p as D,c as p,o as f,r as t,G as l,j as r,a as m,w as i,k as o,t as M,n as G}from"./framework.C7SOrqHQ.js";const U={class:"quick-login__title"},I={key:0},T={class:"quick-login__agreement"},J=S({name:"ProQuickLogin",__name:"index",props:{getCaptcha:{},login:{},countdownDuration:{default:60},errorMessages:{default:()=>({captchaFailed:"获取验证码失败！",loginFailed:"登录失败！"})},className:{default:""}},emits:["success","captchaSent"],setup(E,{emit:y}){const n=E,g=y,a=B({username:"",code:"",remember:!1}),h=D({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]}),{start:q,formattedTime:c,isCounting:b}=F(n.countdownDuration);async function k(){q();try{await n.getCaptcha(),g("captchaSent")}catch(s){return V.error(`${n.errorMessages.captchaFailed}${s.message}`)}}async function $(){try{await n.login(a),g("success")}catch(s){return V.error(`${n.errorMessages.loginFailed}${s.message}`)}}return(s,e)=>(f(),p("div",{class:G(["pro-quick-login",[n.className]])},[t(s.$slots,"header",{},()=>[r("div",U,[t(s.$slots,"title",{},()=>[e[3]||(e[3]=m(" 登录 "))])])]),l(o(N),{model:a,class:"quick-login__form",rules:h.value,onFinish:$},{default:i(()=>[t(s.$slots,"form-header"),l(o(d),{prop:"username"},{default:i(()=>[t(s.$slots,"username-input",{},()=>[l(o(C),{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=u=>a.username=u),placeholder:"请输入账号"},null,8,["modelValue"])])]),_:3}),l(o(d),{prop:"code"},{default:i(()=>[t(s.$slots,"code-input",{},()=>[l(o(C),{modelValue:a.code,"onUpdate:modelValue":e[1]||(e[1]=u=>a.code=u),"show-password":"",placeholder:"验证码"},{append:i(()=>[t(s.$slots,"captcha-button",{isCounting:o(b),time:o(c),onGetCaptcha:k},()=>[o(b)?(f(),p("div",I,[r("span",null,M(o(c))+"秒后重发",1)])):(f(),p("div",{key:1,class:"captcha-button",onClick:k},e[4]||(e[4]=[r("span",null,"获取验证码",-1)])))])]),_:3},8,["modelValue"])])]),_:3}),l(o(d),null,{default:i(()=>[t(s.$slots,"submit-button",{},()=>[l(o(v),{disabled:!a.remember,class:"quick-login__submit",type:"primary",onClick:$},{default:i(()=>e[5]||(e[5]=[m(" 登录 ")])),_:1},8,["disabled"])])]),_:3}),t(s.$slots,"agreement",{},()=>[r("div",T,[l(o(w),{modelValue:a.remember,"onUpdate:modelValue":e[2]||(e[2]=u=>a.remember=u)},null,8,["modelValue"]),t(s.$slots,"agreement-text",{},()=>[e[6]||(e[6]=m(" 我已阅读并同意 ")),e[7]||(e[7]=r("a",{href:""},"《用户协议》",-1)),e[8]||(e[8]=m(" 和 ")),e[9]||(e[9]=r("a",{href:""},"《隐私政策》",-1))])])]),t(s.$slots,"footer",{},()=>[e[10]||(e[10]=r("div",{class:"quick-login__footer"},[r("a",{href:""},"注册"),r("a",{href:""},"忘记密码")],-1))])]),_:3},8,["model","rules"])],2))}});export{J as _};
