import"./base.BdmgHdsK.js";import{E as k}from"./el-overlay.BqfQhs6e.js";import"./el-image-viewer.ROfZEiPQ.js";/* empty css                   */import{E as x}from"./el-progress.vJBajUUT.js";import{E as z}from"./index.CAWPyoIP.js";import{E as B}from"./index.RKxNzSBd.js";import{E as _}from"./index.WZ0sw04i.js";import{d as I,p as c,s as S,c as a,o as s,F as g,B as U,G as m,k as u,w as d,C,j as M,_ as b}from"./framework.C7SOrqHQ.js";import"./vnode.7Q1GY8fL.js";import"./index.BTF4YfDF.js";import"./types.CHlFyNtD.js";import"./aria.9SHySdGF.js";import"./index.126dwtby.js";import"./isSymbol.C7jn4vLP.js";import"./isObject.C3e4t58V.js";import"./icon.D1paMUUC.js";import"./index.CacP4YLb.js";import"./refs.DxbQ4g28.js";import"./index.hhTD2MZf.js";import"./event.BB_Ol6Sd.js";import"./error.Cq9Fpw4b.js";import"./scroll.DMEu3ij1.js";import"./index.Dmme7433.js";import"./use-global-config.DIWKgMVJ.js";import"./index.CQ2QlRVi.js";import"./index.CR5w6Vik.js";import"./typescript.Bp3YSIOJ.js";import"./use-form-common-props.DDNg6-8l.js";import"./cloneDeep.D8Rcep2n.js";import"./isEqual.BOWLGTx_.js";import"./arrayPush.CXZMwWBu.js";import"./index.BxHDt7Km.js";import"./debounce.BwFge-ki.js";import"./index.gDhSDFSO.js";const A={class:"image-uploader-field"},F={key:0,class:"image-preview-list"},L=["onClick"],P=["src"],N=I({__name:"ImageUploaderField",props:{modelValue:{},viewMode:{type:Boolean},multiple:{type:Boolean},maxSize:{}},emits:["update:modelValue","change"],setup(V,{emit:w}){const o=V,p=w,i=c([]);S(()=>{if(o.modelValue){const t=Array.isArray(o.modelValue)?o.modelValue:[o.modelValue];i.value=t.map(e=>({name:e.split("/").pop()||"",url:e}))}else i.value=[]});const h=t=>t.type.startsWith("image/")?o.maxSize&&!(t.size/1024/1024<o.maxSize)?(_.error(`图片大小不能超过 ${o.maxSize}MB!`),!1):!0:(_.error("只能上传图片文件!"),!1);function y(t){const e=t.url,l=o.multiple?[...Array.isArray(o.modelValue)?o.modelValue:[],e]:e;p("update:modelValue",l),p("change",l)}function E(t){const e=i.value.filter(l=>l.url!==t.url).map(l=>l.url);p("update:modelValue",o.multiple?e:e[0]),p("change",o.multiple?e:e[0])}const n=c(!1),f=c("");function v(t){f.value=t.url||"",n.value=!0}return(t,e)=>{const l=C("Plus");return s(),a("div",A,[t.viewMode?(s(),a("div",F,[(s(!0),a(g,null,U(i.value,r=>(s(),a("div",{key:r.url,class:"image-preview-item",onClick:$=>v(r)},[m(u(z),{src:r.url||"",fit:"cover","preview-src-list":[r.url||""]},null,8,["src","preview-src-list"])],8,L))),128))])):(s(),a(g,{key:1},[m(u(x),{"file-list":i.value,multiple:t.multiple,action:"/api/upload","list-type":"picture-card","before-upload":h,"on-success":y,"on-remove":E,"on-preview":v},{default:d(()=>[m(u(B),null,{default:d(()=>[m(l)]),_:1})]),_:1},8,["file-list","multiple"]),m(u(k),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),title:"预览"},{default:d(()=>[M("img",{src:f.value,style:{width:"100%"}},null,8,P)]),_:1},8,["modelValue"])],64))])}}}),he=b(N,[["__scopeId","data-v-0c8b73c0"]]);export{he as default};
