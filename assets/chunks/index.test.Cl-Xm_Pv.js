import{m as s}from"./vue-test-utils.esm-bundler.CXEWdIcj.js";import"./base.D1hT_OMg.js";import{E as f}from"./el-popover.D2JF-F-v.js";import"./el-popper.DVtARkBh.js";import"./el-button.Ks_KV28J.js";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang.BXShka89.js";import{d as u,v as e,i as c,g as o}from"./vi.JYQecGiw.CwfDdTVD.js";import{P as a}from"./framework.CCndWvNN.js";import"./index.dVC2hAAQ.js";import"./types.BG7Bq31m.js";import"./index.B1pLMPru.js";import"./isSymbol.C7jn4vLP.js";import"./isObject.C3e4t58V.js";import"./index.l2C8AFQu.js";import"./icon.ZlYHZ6bL.js";import"./index.CQNcN25s.js";import"./index.BerH9hGA.js";import"./arrayPush.CXZMwWBu.js";import"./index.BESs4zff.js";import"./aria.9SHySdGF.js";import"./index.DT7TJvLG.js";import"./index.DKuONPA3.js";import"./index.CmxAuiKz.js";import"./use-global-config.Cy85fLye.js";import"./index.BTWm3S8P.js";import"./use-form-item.Br6EJJ4d.js";import"./use-form-common-props.CD1z-U6Z.js";import"./index.r5W6hzzQ.js";import"./el-dropdown.BOifsY6J.js";import"./el-scrollbar.D7CKjqK8.js";import"./error.Cq9Fpw4b.js";import"./castArray.nOJHwnz6.js";import"./refs.B6nQtqsB.js";import"./el-dropdown-item.l0sNRNKZ.js";import"./Action.vue_vue_type_script_setup_true_lang.Dpx7dNUG.js";import"./commonjsHelpers.BosuxZz1.js";import"./vite-browser-external_commonjs-proxy.BC9WSf1a.js";u("linkActions 组件",()=>{const m=[{text:"编辑",onClick:e.fn()},{text:"删除",onClick:e.fn()}];c("应该正确渲染操作按钮",async()=>{const i=s(p,{props:{actions:m}});await a(),await a();const t=i.findAll(".el-button");o(t).toHaveLength(2),o(t[0].text()).toBe("编辑"),o(t[1].text()).toBe("删除")}),c("应该正确触发点击事件",async()=>{const i=s(p,{props:{actions:m}});await a(),await a(),await i.findAll(".el-button")[0].trigger("click"),o(m[0].onClick).toHaveBeenCalled()}),c("应该正确处理确认弹窗",async()=>{const i=[{text:"删除",onClick:e.fn(),confirm:!0,confirmText:"确认删除?"}],t=s(p,{props:{actions:i}});await t.find(".el-button").trigger("click");const n=t.findComponent(f);o(n.exists()).toBe(!0),o(n.props("title")).toBe("确认删除?"),await n.vm.$emit("confirm"),o(i[0].onClick).toHaveBeenCalled()}),c("应该正确处理权限控制",()=>{const i=[{text:"编辑",onClick:e.fn(),permission:"edit"},{text:"删除",onClick:e.fn(),permission:"delete"}],r=s(p,{props:{actions:i,hasPermission:n=>["delete"].includes(n)}}).findAll(".el-button");o(r).toHaveLength(1),o(r[0].text()).toBe("删除")}),c("应该正确处理条件显示",async()=>{const i=[{text:"编辑",onClick:e.fn()},{text:"删除",onClick:e.fn(),show:r=>r.status==="active"}],t=s(p,{props:{actions:i,record:{status:"inactive"}}});o(t.findAll(".el-button")).toHaveLength(1),await t.setProps({record:{status:"active"}}),await a(),o(t.findAll(".el-button")).toHaveLength(2)}),c("应该正确处理禁用状态",()=>{const i=[{text:"编辑",onClick:e.fn()},{text:"删除",onClick:e.fn(),disabled:n=>n.locked}],r=s(p,{props:{actions:i,record:{locked:!0}}}).findAll(".el-button");o(r[1].classes()).toContain("is-disabled")}),c("应该正确处理更多菜单",async()=>{const i=Array.from({length:6}).fill(null).map((b,d)=>({text:`操作${d+1}`,onClick:e.fn()})),t=s(p,{props:{actions:i,maxCount:3}}),r=t.findAll(".el-button:not(.more-action)");o(r).toHaveLength(3);const n=t.find(".more-action");o(n.exists()).toBe(!0),await n.trigger("click");const l=t.findAll(".el-dropdown-menu__item");o(l).toHaveLength(3)})});
