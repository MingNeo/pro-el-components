import{m as r}from"./vue-test-utils.esm-bundler.BNPP31t0.js";import"./base.Dwgz6jSd.js";/* empty css                   */import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.B2EgZ6VN.js";import{v as i,d as l,i as p,g as o}from"./vi.JYQecGiw.CsLlcVZs.js";import{E as c}from"./index.BD-RLF64.js";import"./framework.igcgEEdr.js";import"./el-button.k3Ms4Xdh.js";import"./icon.C3T6eoYR.js";import"./types.DNi1ojkw.js";import"./index.mDR6Kexr.js";import"./isSymbol.C7jn4vLP.js";import"./isObject.C3e4t58V.js";import"./index.BQOwn3WU.js";import"./index.DBJOzW_o.js";import"./use-global-config.CrFx92Tt.js";import"./index.CRCbWsfX.js";import"./index.BjB1lFfg.js";import"./use-form-item.Daeosa58.js";import"./use-form-common-props.BIymRJo1.js";import"./el-checkbox.B0vmRW9S.js";import"./index.BI4o4ewH.js";import"./arrayPush.CXZMwWBu.js";import"./event.BB_Ol6Sd.js";import"./error.Cq9Fpw4b.js";import"./isEqual.DkZuJHVE.js";/* empty css                     */import"./el-input.DQ30HcuH.js";import"./index.D353ODTN.js";import"./typescript.Bp3YSIOJ.js";import"./index.8K3Om35h.js";import"./index.BndPLsPe.js";/* empty css              */import"./index.B5Qmna9d.js";import"./index.DbWT0aQr.js";import"./castArray.nshRf-Q-.js";import"./baseClone.p2iRr-IY.js";import"./initCloneObject.BLfUkf_9.js";import"./commonjsHelpers.BosuxZz1.js";import"./vite-browser-external_commonjs-proxy.BC9WSf1a.js";import"./aria.9SHySdGF.js";i.mock("element-plus",async()=>({...await i.importActual("element-plus"),ElMessage:{error:i.fn()}}));l("QuickLogin 组件",()=>{const n=i.fn().mockResolvedValue(void 0),s=i.fn().mockResolvedValue(void 0);p("应该正确渲染",()=>{const t=r(a,{props:{getCaptcha:n,login:s}});o(t.find(".pro-quick-login").exists()).toBe(!0)}),p("应该显示默认标题",()=>{const t=r(a,{props:{getCaptcha:n,login:s}});o(t.text()).toContain("登录")}),p("应该渲染用户名输入框",()=>{const e=r(a,{props:{getCaptcha:n,login:s}}).find('input[placeholder="请输入账号"]');o(e.exists()).toBe(!0)}),p("应该渲染验证码输入框",()=>{const e=r(a,{props:{getCaptcha:n,login:s}}).find('input[placeholder="验证码"]');o(e.exists()).toBe(!0)}),p("应该渲染获取验证码按钮",()=>{const t=r(a,{props:{getCaptcha:n,login:s}});o(t.text()).toContain("获取验证码")}),p("应该正确调用获取验证码方法",async()=>{const t=i.fn().mockResolvedValue(void 0);await r(a,{props:{getCaptcha:t,login:s}}).vm.handleGetCaptcha(),o(t).toHaveBeenCalled()}),p("获取验证码成功后应该触发 captchaSent 事件",async()=>{const t=i.fn().mockResolvedValue(void 0),e=r(a,{props:{getCaptcha:t,login:s}});await e.vm.handleGetCaptcha(),o(e.emitted("captchaSent")).toBeTruthy()}),p("获取验证码失败时应该显示错误信息",async()=>{const t="网络错误",e=i.fn().mockRejectedValue(new Error(t));await r(a,{props:{getCaptcha:e,login:s}}).vm.handleGetCaptcha(),o(c.error).toHaveBeenCalled()}),p("应该支持自定义验证码失败提示",async()=>{const t="自定义错误提示",e=i.fn().mockRejectedValue(new Error("error"));await r(a,{props:{getCaptcha:e,login:s,errorMessages:{captchaFailed:t}}}).vm.handleGetCaptcha(),o(c.error).toHaveBeenCalledWith(o.stringContaining(t))}),p("应该正确调用登录方法",async()=>{const t=i.fn().mockResolvedValue(void 0),e=r(a,{props:{getCaptcha:n,login:t}});e.vm.formData.username="testuser",e.vm.formData.code="123456",await e.vm.handleSubmit(),o(t).toHaveBeenCalledWith(o.objectContaining({username:"testuser",code:"123456"}))}),p("登录成功后应该触发 success 事件",async()=>{const t=i.fn().mockResolvedValue(void 0),e=r(a,{props:{getCaptcha:n,login:t}});await e.vm.handleSubmit(),o(e.emitted("success")).toBeTruthy()}),p("登录失败时应该显示错误信息",async()=>{const t=i.fn().mockRejectedValue(new Error("登录失败"));await r(a,{props:{getCaptcha:n,login:t}}).vm.handleSubmit(),o(c.error).toHaveBeenCalled()}),p("应该支持自定义登录失败提示",async()=>{const t="自定义登录失败提示",e=i.fn().mockRejectedValue(new Error("error"));await r(a,{props:{getCaptcha:n,login:e,errorMessages:{loginFailed:t}}}).vm.handleSubmit(),o(c.error).toHaveBeenCalledWith(o.stringContaining(t))}),p("应该使用默认倒计时时长 60 秒",()=>{const t=r(a,{props:{getCaptcha:n,login:s}});o(t.vm.$props.countdownDuration).toBe(60)}),p("应该支持自定义倒计时时长",()=>{const t=r(a,{props:{getCaptcha:n,login:s,countdownDuration:120}});o(t.vm.$props.countdownDuration).toBe(120)}),p("应该支持自定义类名",()=>{const t=r(a,{props:{getCaptcha:n,login:s,className:"custom-class"}});o(t.find(".pro-quick-login.custom-class").exists()).toBe(!0)}),p("应该包含记住协议的复选框",()=>{const t=r(a,{props:{getCaptcha:n,login:s}});o(t.find(".quick-login__agreement").exists()).toBe(!0)}),p("未勾选协议时登录按钮应该禁用",()=>{const e=r(a,{props:{getCaptcha:n,login:s}}).find(".quick-login__submit");o(e.attributes("disabled")).toBeDefined()}),p("应该支持标题插槽",()=>{const t=r(a,{props:{getCaptcha:n,login:s},slots:{title:"自定义标题"}});o(t.text()).toContain("自定义标题")}),p("应该支持表单头部插槽",()=>{const t=r(a,{props:{getCaptcha:n,login:s},slots:{formHeader:'<div class="custom-header">表单头部</div>'}});o(t.find(".custom-header").exists()).toBe(!0)}),p("应该支持协议文本插槽",()=>{const t=r(a,{props:{getCaptcha:n,login:s},slots:{agreementText:"自定义协议文本"}});o(t.text()).toContain("自定义协议文本")})});
