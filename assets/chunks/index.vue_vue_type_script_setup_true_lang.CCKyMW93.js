import{g as R,p as D}from"./index.BQOwn3WU.js";import"./base.Dwgz6jSd.js";import{E as M}from"./el-button.k3Ms4Xdh.js";import"./el-input.DQ30HcuH.js";/* empty css              *//* empty css              */import{v as h}from"./v4.C6aID195.js";import{_ as T}from"./index.vue_vue_type_script_setup_true_lang.CR4Q-k9N.js";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang.Cm45yPGm.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang.CRYnw7sj.js";import{E as U}from"./icon.C3T6eoYR.js";import{d as A}from"./index.vue_vue_type_script_setup_true_lang.CgsMylzL.js";import{d as j,h as g,p as G,c as _,o as d,G as i,e as b,w as u,b as k,F as K,a as x,t as y,k as r,K as S,j as v}from"./framework.igcgEEdr.js";const q={class:"pro-table-form"},z={key:0,class:"pro-table-form-footer"},H={class:"flex items-center"},J={class:"total-row-text"},le=j({name:"ProTableForm",inheritAttrs:!1,__name:"index",props:{propPrefix:{},modelValue:{},columns:{},viewMode:{type:Boolean}},emits:["update:modelValue","change","validate"],setup(C,{expose:I,emit:N}){const l=C,m=N,n=g(()=>{var t,e;return((e=(t=l.modelValue)==null?void 0:t.map)==null?void 0:e.call(t,(o,a)=>{const s=o.id||h();return{...o,_sortIndex:a,id:s}}))||[]}),c=G(1);function w(){const t=h(),e=[...n.value,...Array.from({length:c.value}).map(()=>({id:t}))].map((o,a)=>({...o,_sortIndex:a}));m("update:modelValue",e),m("change",e)}function V(t){const e=n.value.filter((o,a)=>a!==t).map((o,a)=>({...o,_sortIndex:a}));m("update:modelValue",e),m("change",e)}function B(t,e){const o=[...n.value];o[e]={...o[e],...t},m("update:modelValue",o),m("change",o)}const E=g(()=>[...l.columns,...l.viewMode?[]:[{label:"操作",prop:"actions",columnType:"actions",width:60,className:"pro-table-form-actions-column",actions:[{icon:R,onClick:(t,e,o)=>V(o),confirm:!0,confirmText:"确认删除?"}]}]]);return I({addRow:w,deleteRow:V}),(t,e)=>(d(),_("div",q,[i(r(P),S({columns:E.value,data:n.value},t.$attrs),{"column-default":u(({row:o,$index:a=0,column:s})=>[s.customRender?(d(),_(K,{key:0},[x(y(s.customRender(o,s,a)),1)],64)):s.columnType==="actions"&&!l.viewMode?(d(),k(r(T),{key:1,type:"link",actions:s.actions,record:o,column:s,index:a},null,8,["actions","record","column","index"])):a>=0?(d(),k(r(F),{key:2,modelValue:n.value[a],"onUpdate:modelValue":p=>n.value[a]=p,column:1,"prop-prefix":[l.propPrefix,a].flat(1/0),fields:[s].map(({customRender:p,...f})=>({...f,prop:f.prop||f.name})),"show-label":!1,"view-mode":l.viewMode,onChange:p=>B(p,a)},null,8,["modelValue","onUpdate:modelValue","prop-prefix","fields","view-mode","onChange"])):b("",!0)]),_:1},16,["columns","data"]),l.viewMode?b("",!0):(d(),_("div",z,[i(r(M),{class:"add-row-btn",onClick:w},{icon:u(()=>[i(r(U),null,{default:u(()=>[i(r(D))]),_:1})]),default:u(()=>[e[1]||(e[1]=x(" 添加行 "))]),_:1}),v("div",H,[i(r(A),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),min:1},null,8,["modelValue"]),e[2]||(e[2]=v("span",{class:"row-text"},"行",-1))]),v("span",J,"当前总行数："+y(n.value.length),1)]))]))}});export{le as _};
