import"./base.Dwgz6jSd.js";import{E as u}from"./el-button.k3Ms4Xdh.js";/* empty css                   *//* empty css                     */import{unbind as n}from"./index.B6On7QUW.js";/* empty css                *//* empty css              */import{E as b}from"./index.BsakEZKL.js";import{v as N}from"./directive.CEBmWU5B.js";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang.Cm45yPGm.js";import{E as R}from"./index.DbWT0aQr.js";import{d as I,p as g,h as L,q as T,b as p,o as s,k as l,K as c,w as d,a2 as U,c as v,G as h,r as m,e as j,j as q,B as G,a as w,t as C,F as B,P as K}from"./framework.igcgEEdr.js";const z={class:"dialog-footer"},ae=I({name:"ProModalForm",__name:"index",props:{title:{},width:{default:500},modelValue:{type:Boolean},loading:{type:Boolean,default:!1},defaultValue:{default:()=>({})},formData:{},viewMode:{type:Boolean},fields:{},column:{default:2},propPrefix:{},formProps:{},formItemProps:{},closeOnSuccess:{type:Boolean,default:!0},resetOnClose:{type:Boolean,default:!0},actions:{}},emits:["update:modelValue","update:formData","formChange","ok","cancel"],setup(D,{expose:P,emit:F}){const o=D,t=F,r=g(),k=g(n(o.defaultValue)),a=L({get:()=>o.formData??k.value,set:e=>{k.value=e,t("update:formData",e),t("formChange",e)}});T(()=>o.defaultValue,e=>{a.value=n(e)},{deep:!0});async function y(){var e;try{o.viewMode||await((e=r.value)==null?void 0:e.validate()),t("ok",a.value),(o.viewMode||o.closeOnSuccess)&&t("update:modelValue",!1)}catch(i){console.error("Form validation failed:",i)}}function f(){t("update:modelValue",!1),t("cancel"),o.resetOnClose&&(a.value=n(o.defaultValue))}function V(e){a.value=e}function E(e){K(()=>{o.resetOnClose&&(a.value=n(o.defaultValue))}),e()}return P({formRef:r,formData:a,resetForm:()=>{var e;return(e=r.value)==null?void 0:e.resetFields()},validate:()=>{var e;return(e=r.value)==null?void 0:e.validate()}}),(e,i)=>(s(),p(l(b),c({class:"pro-modal-form","model-value":e.modelValue,width:e.width,title:e.title,"destroy-on-close":"","before-close":E},e.$attrs,{"onUpdate:modelValue":f}),{footer:d(()=>[m(e.$slots,"footer",{close:f,ok:y},()=>[q("div",z,[e.actions?(s(!0),v(B,{key:0},G(e.actions,({text:M,...O},$)=>(s(),p(l(u),c({key:$,ref_for:!0},O),{default:d(()=>[w(C(M),1)]),_:2},1040))),128)):(s(),v(B,{key:1},[h(l(u),{onClick:f},{default:d(()=>i[0]||(i[0]=[w(" 取消 ")])),_:1}),h(l(u),{type:"primary",onClick:y},{default:d(()=>[w(C(e.viewMode?"确定":"提交"),1)]),_:1})],64))])])]),default:d(()=>[U((s(),v("div",null,[h(l(R),c({ref_key:"formRef",ref:r,model:a.value,"label-width":"auto","label-position":"right"},e.formProps),{default:d(()=>[m(e.$slots,"header"),m(e.$slots,"default",{data:a.value,onChange:V,formRef:r.value},()=>[e.fields?(s(),p(l(S),{key:0,"model-value":a.value,column:e.column,"view-mode":e.viewMode,fields:e.fields,"form-item-props":e.formItemProps,"prop-prefix":e.propPrefix,"onUpdate:modelValue":V},null,8,["model-value","column","view-mode","fields","form-item-props","prop-prefix"])):j("",!0)]),m(e.$slots,"extra")]),_:3},16,["model"])])),[[l(N),e.loading]])]),_:3},16,["model-value","width","title"]))}});export{ae as _};
