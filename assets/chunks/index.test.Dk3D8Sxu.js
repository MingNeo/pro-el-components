import{m as r}from"./vue-test-utils.esm-bundler.BNPP31t0.js";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang.CCKyMW93.js";import{d as s,i as m,g as t}from"./vi.JYQecGiw.CsLlcVZs.js";import"./framework.igcgEEdr.js";import"./index.BQOwn3WU.js";import"./base.Dwgz6jSd.js";import"./el-button.k3Ms4Xdh.js";import"./icon.C3T6eoYR.js";import"./types.DNi1ojkw.js";import"./index.mDR6Kexr.js";import"./isSymbol.C7jn4vLP.js";import"./isObject.C3e4t58V.js";import"./index.DBJOzW_o.js";import"./use-global-config.CrFx92Tt.js";import"./index.CRCbWsfX.js";import"./index.BjB1lFfg.js";import"./use-form-item.Daeosa58.js";import"./use-form-common-props.BIymRJo1.js";import"./el-input.DQ30HcuH.js";import"./index.D353ODTN.js";import"./typescript.Bp3YSIOJ.js";import"./index.BI4o4ewH.js";import"./arrayPush.CXZMwWBu.js";import"./event.BB_Ol6Sd.js";import"./index.8K3Om35h.js";import"./index.BndPLsPe.js";import"./error.Cq9Fpw4b.js";/* empty css              *//* empty css              */import"./v4.C6aID195.js";import"./index.vue_vue_type_script_setup_true_lang.CR4Q-k9N.js";/* empty css                    */import"./el-popper.CZJRST1P.js";import"./index.Brw29sq5.js";import"./aria.9SHySdGF.js";import"./el-scrollbar.HZhNcw01.js";/* empty css                   */import"./Action.vue_vue_type_script_setup_true_lang.maaIIJkR.js";import"./index.CKIxfO9Z.js";import"./castArray.nshRf-Q-.js";import"./refs.n9wIXTtR.js";import"./index.vue_vue_type_script_setup_true_lang.Cm45yPGm.js";/* empty css                     */import"./el-tooltip.l0sNRNKZ.js";import"./FieldWrapper.vue_vue_type_script_setup_true_lang.BQIeAx6E.js";/* empty css               */import"./constants.0YSy3Igo.js";import"./helper.DcuHLwUz.js";import"./dayjs.min.Ba62AOpW.js";import"./commonjsHelpers.BosuxZz1.js";import"./useFieldWatch.CAezyHFE.js";import"./Wrapper.vue_vue_type_script_setup_true_lang.CPkOFA02.js";/* empty css               */import"./index.DbWT0aQr.js";import"./baseClone.p2iRr-IY.js";import"./isEqual.DkZuJHVE.js";import"./initCloneObject.BLfUkf_9.js";import"./index.vue_vue_type_script_setup_true_lang.CgsMylzL.js";/* empty css                        *//* empty css                  */import"./el-tag.BDcJ6G_i.js";import"./el-select.D9tonctu.js";import"./scroll.DxJqq-ED.js";import"./debounce.BwFge-ki.js";import"./el-checkbox.B0vmRW9S.js";/* empty css                    */import"./index.vue_vue_type_script_setup_true_lang.BT-Ywz00.js";/* empty css                   *//* empty css              */import"./index.SQqbOIf2.js";import"./cloneDeep.DdLfN6Fq.js";import"./index.BsakEZKL.js";import"./index.vue_vue_type_script_setup_true_lang.32sqq2C1.js";/* empty css                          *//* empty css                 */import"./index.RVi9Xofb.js";import"./index.vue_vue_type_script_setup_true_lang.BVOXUtzn.js";/* empty css                          *//* empty css                   *//* empty css              *//* empty css                *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css                       *//* empty css              *//* empty css              */import"./index.vue_vue_type_script_setup_true_lang.D98OUrhU.js";import"./index.vue_vue_type_script_setup_true_lang.CdsKtYT4.js";/* empty css              *//* empty css              *//* empty css              */import"./el-table-column.BBssXNKa.js";/* empty css                                                      *//* empty css              */import"./index.CemNZkGQ.js";import"./index.CaFP4xeD.js";import"./baseUniq.CpJglj-j.js";import"./index.vue_vue_type_script_setup_true_lang.CRYnw7sj.js";import"./index.WNI6fmhU.js";import"./index.BTYb9I48.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang.BO9cYbPa.js";import"./helper.AYP33an4.js";import"./index.DYDoBdSP.js";import"./index.vue_vue_type_script_setup_true_lang.DgUHcPJC.js";import"./index.vue_vue_type_script_setup_true_lang.CWXAaeVB.js";import"./vite-browser-external_commonjs-proxy.BC9WSf1a.js";s("tableForm 组件",()=>{const i=[{prop:"name",label:"名称",type:"input"},{prop:"age",label:"年龄",type:"number"}],a=[{id:"1",name:"张三",age:25},{id:"2",name:"李四",age:30}];m("应该正确渲染",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(o.find(".pro-table-form").exists()).toBe(!0)}),m("应该正确显示数据",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(o.vm.tableData.length).toBe(2)}),m("应该自动为没有 id 的数据项添加 id",()=>{r(p,{props:{columns:i,modelValue:[{name:"张三",age:25},{name:"李四",age:30}],propPrefix:"tableForm"}}).vm.tableData.forEach(e=>{t(e.id).toBeDefined(),t(typeof e.id).toBe("string")})}),m("应该为每行数据添加 _sortIndex",()=>{r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}}).vm.tableData.forEach((l,e)=>{t(l._sortIndex).toBe(e)})}),m("非 viewMode 时应该显示操作列",()=>{const e=r(p,{props:{columns:i,modelValue:a,viewMode:!1,propPrefix:"tableForm"}}).vm.columns.find(n=>n.prop==="actions");t(e).toBeDefined()}),m("viewMode 时不应该显示操作列",()=>{const e=r(p,{props:{columns:i,modelValue:a,viewMode:!0,propPrefix:"tableForm"}}).vm.columns.find(n=>n.prop==="actions");t(e).toBeUndefined()}),m("非 viewMode 时应该显示底部操作区",()=>{const o=r(p,{props:{columns:i,modelValue:a,viewMode:!1,propPrefix:"tableForm"}});t(o.find(".pro-table-form-footer").exists()).toBe(!0)}),m("viewMode 时不应该显示底部操作区",()=>{const o=r(p,{props:{columns:i,modelValue:a,viewMode:!0,propPrefix:"tableForm"}});t(o.find(".pro-table-form-footer").exists()).toBe(!1)}),m("应该正确添加行",async()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}}),l=o.vm.tableData.length;await o.vm.addRow(),t(o.emitted("update:modelValue")).toBeTruthy(),t(o.emitted("change")).toBeTruthy();const e=o.emitted("update:modelValue")[0][0];t(e.length).toBe(l+1)}),m("应该正确删除行",async()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}}),l=o.vm.tableData.length;await o.vm.deleteRow(0),t(o.emitted("update:modelValue")).toBeTruthy(),t(o.emitted("change")).toBeTruthy();const e=o.emitted("update:modelValue")[0][0];t(e.length).toBe(l-1)}),m("删除行后应该更新 _sortIndex",async()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});await o.vm.deleteRow(0),o.emitted("update:modelValue")[0][0].forEach((e,n)=>{t(e._sortIndex).toBe(n)})}),m("应该正确处理表单项变更",async()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}}),l={name:"王五",age:35};await o.vm.handleFormItemsChange(l,0),t(o.emitted("update:modelValue")).toBeTruthy(),t(o.emitted("change")).toBeTruthy();const e=o.emitted("update:modelValue")[0][0];t(e[0]).toMatchObject(l)}),m("应该支持批量添加多行",async()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});o.vm.addRowNumber=3;const l=o.vm.tableData.length;await o.vm.addRow();const e=o.emitted("update:modelValue")[0][0];t(e.length).toBe(l+3)}),m("应该显示当前总行数",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(o.text()).toContain(`当前总行数：${a.length}`)}),m("应该支持自定义 propPrefix",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"items"}});t(o.vm.$props.propPrefix).toBe("items")}),m("应该正确透传属性",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"},attrs:{"data-testid":"table-form"}});t(o.vm.$attrs["data-testid"]).toBe("table-form")}),m("操作列应该有删除按钮配置",()=>{const e=r(p,{props:{columns:i,modelValue:a,viewMode:!1,propPrefix:"tableForm"}}).vm.columns.find(n=>n.prop==="actions");t(e==null?void 0:e.actions).toBeDefined(),t(e==null?void 0:e.actions[0].confirm).toBe(!0),t(e==null?void 0:e.actions[0].confirmText).toBe("确认删除?")}),m("应该暴露 addRow 和 deleteRow 方法",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(typeof o.vm.addRow).toBe("function"),t(typeof o.vm.deleteRow).toBe("function")}),m("空数据时应该正确显示",()=>{const o=r(p,{props:{columns:i,modelValue:[],propPrefix:"tableForm"}});t(o.vm.tableData.length).toBe(0),t(o.text()).toContain("当前总行数：0")}),m("应该支持自定义渲染",()=>{const l=r(p,{props:{columns:[{prop:"name",label:"名称",type:"input",customRender:e=>`姓名: ${e.name}`}],modelValue:a,propPrefix:"tableForm"}});t(l.vm.columns.length).toBeGreaterThan(0)}),m("addRowNumber 默认值应该为 1",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(o.vm.addRowNumber).toBe(1)}),m("应该显示添加行按钮",()=>{const o=r(p,{props:{columns:i,modelValue:a,propPrefix:"tableForm"}});t(o.find(".add-row-btn").exists()).toBe(!0)})});
