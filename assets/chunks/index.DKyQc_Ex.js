import{d as C}from"./debounce.BwFge-ki.js";import{ad as G,p as i,h as f,P as H}from"./framework.igcgEEdr.js";import{useRequest as I}from"./index.VGyafNOA.js";import"./isObject.C3e4t58V.js";import"./isSymbol.C7jn4vLP.js";function V(A,{form:m,immediate:F=!0,defaultPageSize:D=10,defaultSearchData:c={},getTotal:w=t=>Array.isArray(t)?t.length:(t==null?void 0:t.total)||0,getData:L=t=>Array.isArray(t)?t:(t==null?void 0:t.data)||[],onReset:v=()=>{},onSearchDataChange:g=(t,a)=>{},debounceTime:T=100,mergeData:_=!1,refetchOnReset:j=!0}={}){const t=G(m)?m:i(),a=i(c.pageNo||1),n=i(+(c.pageSize||D)),p=i({}),l=i({...c}),z=(e,u=!1)=>{l.value=u?{...l.value,...e}:e,g==null||g(l.value,{pageNo:a.value,pageSize:n.value})},{data:r,isLoading:b,execute:k}=I(A,{immediate:!1}),h=f(()=>w(r==null?void 0:r.value)),q=f((e=[])=>{const u=L(r==null?void 0:r.value)||[];return _?[...e,...u]:u}),y=async(e={},u=!0)=>{z({...p.value,...e},u),await H(),k({...l.value,pageNo:a.value,pageSize:n.value,...e})},B=C(y,T,{leading:!0,trailing:!1}),o=(e={},{mergeParams:u=!0,debounce:s=!0}={})=>s?B(e,u):y(e,u);function E(){t.value&&Object.keys(l.value).forEach(e=>{try{t.value[e]=l.value[e]}catch(u){console.log(u)}})}E();const O=({column:e,prop:u,order:s})=>{a.value=1,o({prop:u,sortBy:u,order:s,column:e})},S=()=>{var u,s,x;const e=(v==null?void 0:v())||{};(u=t==null?void 0:t.value)!=null&&u.resetFields?(x=(s=t==null?void 0:t.value)==null?void 0:s.resetFields)==null||x.call(s):p.value={...e},a.value=1,n.value=+l.value.pageSize,z({...e}),j&&o(l.value)},d=()=>{b.value||(a.value+=1,o())},N=e=>{n.value=e,a.value=1,o()},P=e=>(a.value=e,o());return F&&o(),{searchFormRef:t,data:q,searchState:p,searchData:l,loading:b,fetchData:o,loadNextPage:d,onSortChange:O,currentPage:a,pageSize:n,total:h,changePageSize:N,changePageNo:P,pagination:f(()=>({currentPage:a.value,pageSize:n.value,total:h.value,onSizeChange:N,onCurrentChange:P})),reset:S,search:{onSubmit:(e={})=>(a.value=1,o(e)),onReset:S}}}export{V as useTableList};
