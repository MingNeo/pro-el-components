import{a as q}from"./index.WNI6fmhU.js";import{d as J}from"./dayjs.min.Ba62AOpW.js";import"./base.Dwgz6jSd.js";import"./el-table-column.BBssXNKa.js";import"./el-tag.BDcJ6G_i.js";import{b as Q}from"./el-select.D9tonctu.js";import"./el-scrollbar.HZhNcw01.js";import"./el-popper.CZJRST1P.js";import"./el-input.DQ30HcuH.js";import"./el-checkbox.B0vmRW9S.js";import"./el-tooltip.l0sNRNKZ.js";import{_ as U}from"./ColumnSetting.vue_vue_type_script_setup_true_lang.BO9cYbPa.js";/* empty css                                                      */import{defaultGetColumnKeys as W,getColumnKeys as X,getRenderProps as B,defaultSaveColumnKeys as Z}from"./helper.AYP33an4.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as ee,m as te}from"./index.mDR6Kexr.js";import{c as ae,a as re,b as se,E as oe}from"./index.DYDoBdSP.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang.DgUHcPJC.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang.CR4Q-k9N.js";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang.CWXAaeVB.js";/* empty css                          *//* empty css                 *//* empty css                          *//* empty css                   *//* empty css              *//* empty css                     *//* empty css                *//* empty css              */import"./el-button.k3Ms4Xdh.js";/* empty css                   *//* empty css              *//* empty css                        *//* empty css                  *//* empty css                    *//* empty css               *//* empty css               *//* empty css              *//* empty css                       *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{d as pe,p as R,h as S,s as de,$ as fe,c as f,o as s,n as me,b as v,e as _,j as ye,k as d,w as g,r as h,G as ue,a9 as ge,B as T,a1 as O,ab as I,F as A,K as u,t as k,H as F,N as ce,a as $,L as he}from"./framework.igcgEEdr.js";function be(n,t,m,l){for(var y=-1,c=n==null?0:n.length;++y<c;){var b=n[y];t(l,b,m(b),n)}return l}function ve(n,t,m,l){return ae(n,function(y,c,b){t(l,y,m(y),b)}),l}function _e(n,t){return function(m,l){var y=ee(m)?be:ve,c={};return y(m,n,Q(l),c)}}var ke=_e(function(n,t,m){te(n,m,t)});const Ce={key:0,class:"header-actions"},Be=["href"],Se=["src"],Ae={key:1},_t=pe({name:"ProTable",inheritAttrs:!1,__name:"index",props:{tableId:{},columnSetting:{type:Boolean,default:void 0},autoHeight:{type:Boolean,default:void 0},class:{},format:{},columns:{},pagination:{},bottomOffset:{default:100},savedConfig:{},actions:{},title:{},data:{},size:{},width:{},height:{},maxHeight:{},fit:{type:Boolean},stripe:{type:Boolean},border:{type:Boolean},rowKey:{},context:{},showHeader:{type:Boolean},showSummary:{type:Boolean},sumText:{},summaryMethod:{},rowClassName:{},rowStyle:{},cellClassName:{},cellStyle:{},headerRowClassName:{},headerRowStyle:{},headerCellClassName:{},headerCellStyle:{},highlightCurrentRow:{type:Boolean},currentRowKey:{},emptyText:{},expandRowKeys:{},defaultExpandAll:{type:Boolean},defaultSort:{},tooltipEffect:{},tooltipOptions:{},spanMethod:{},selectOnIndeterminate:{type:Boolean},indent:{},treeProps:{},lazy:{type:Boolean},load:{},className:{},style:{},tableLayout:{},scrollbarAlwaysOn:{type:Boolean},flexible:{type:Boolean},showOverflowTooltip:{type:[Boolean,Object]},tooltipFormatter:{},appendFilterPanelTo:{},scrollbarTabindex:{}},setup(n){var E,C,K;const t=n,m=he("isInListPage",!1),l=t.tableId||((E=window.location.pathname)==null?void 0:E.replace(/\//g,"_")),y=R(),c=R((((K=(C=t.savedConfig)==null?void 0:C.getColumnKeys)==null?void 0:K.call(C,l))??W(l))||[]),b=S(()=>c.value||X(t.columns)),L=S(()=>{const r=(t.columns||[]).map(o=>{var i,e,a;return{...o,width:o.width||(o.columnType==="actions"?150:void 0),mappingMap:o.renderAs==="enum"&&((e=(i=o.fieldProps)==null?void 0:i.options)!=null&&e.length)?ke((a=o.fieldProps)==null?void 0:a.options,"value"):{}}});if(t.columnSetting&&b.value.length){const o=r.filter(e=>e.columnType==="actions");return[...b.value.map(e=>e.visible?r.find(a=>a.prop===e.prop):null).filter(Boolean)||[],...o||[]]}return r}),j=S(()=>{var i;if(!t.pagination)return t.data;const{pageSize:r=10,currentPage:o=1}=t.pagination;return(i=t.data)==null?void 0:i.slice((o-1)*r,o*r)});function D(r){var e;c.value=r;const o=((e=t.savedConfig)==null?void 0:e.saveColumnKeys)??Z,i=r.every(a=>a.visible);o(l,r,i)}const V=R();de(w),q(window,"resize",w);function w(){var r;(t.autoHeight??m)&&(V.value=window.innerHeight-(((r=y.value)==null?void 0:r.getBoundingClientRect().top)||0)-t.bottomOffset)}const x=fe(),Y=S(()=>Object.keys(x).filter(r=>r!=="default"));return(r,o)=>(s(),f("div",{class:me(`pro-table ${t.class}`)},[t.title||t.actions?(s(),v(d(ie),{key:0,title:t.title,size:"small",actions:t.actions,class:"pro-table-header"},{left:g(()=>[h(r.$slots,"left")]),right:g(()=>[h(r.$slots,"headerRight")]),actions:g(()=>[h(r.$slots,"actions")]),_:3},8,["title","actions"])):_("",!0),ye("div",{ref_key:"tableRef",ref:y,class:"pro-table-inner"},[ue(d(se),u({class:"pro-el-table",data:j.value},r.$attrs),ge({default:g(i=>[h(r.$slots,"default",O(I(i||{}))),(s(!0),f(A,null,T(L.value,e=>(s(),v(d(re),u({key:e.prop,label:e.label,prop:e.prop,ref_for:!0},e),{header:g(({$index:a})=>[e.columnType==="actions"?(s(),f("div",Ce,[$(k(e.label||"操作")+" ",1),r.columnSetting?(s(),v(U,{key:0,columns:t.columns,"table-key":d(l),"saved-column-keys":c.value,onSave:D},null,8,["columns","table-key","saved-column-keys"])):_("",!0)])):e.type!=="selection"?h(r.$slots,"column-header",u({key:1,ref_for:!0},{column:e,$index:a})):_("",!0)]),default:g(({row:a,$index:P})=>[e.columnType==="actions"?(s(),v(d(ne),u({key:0,ref_for:!0},e,{record:a,type:"link",index:P}),null,16,["record","index"])):e.type!=="selection"?h(r.$slots,"column-default",u({key:1,ref_for:!0},{$index:P,row:a,column:e}),()=>{var N,z,M,H;return[e.renderAs&&!e.customRender?(s(),f(A,{key:0},[e.renderAs==="file"?(s(),f("div",u({key:0,class:"file-links",ref_for:!0},d(B)(e.renderProps,a,e)),[(s(!0),f(A,null,T([a[e.prop]].flat(),(p,G)=>(s(),f("a",{key:G,target:"_blank",href:typeof p=="string"?p:p==null?void 0:p.url},k(typeof p=="string"?"附件":p==null?void 0:p.name),9,Be))),128))],16)):e.renderAs==="image"?(s(),f("img",u({key:1,src:a[e.prop],alt:"",class:"table-image",ref_for:!0},d(B)(e.renderProps,a,e)),null,16,Se)):e.renderAs==="date"?(s(),f("span",u({key:2,ref_for:!0},d(B)(e.renderProps,a,e)),k(a[e.prop]?d(J)(a[e.prop]).format(((N=e.fieldProps)==null?void 0:N.format)||"YYYY-MM-DD"):""),17)):e.renderAs&&typeof e.renderAs!="string"?(s(),v(F(e.renderAs),u({key:3,ref_for:!0},{...a[e.prop],...d(B)(e.renderProps,a,e)}),null,16)):e.renderAs==="enum"?(s(),v(F((z=e.mappingMap[a[e.prop]])!=null&&z.status?d(le):"div"),{key:4,status:(M=e.mappingMap[a[e.prop]])==null?void 0:M.status,style:ce((H=e.mappingMap[a[e.prop]])==null?void 0:H.style)},{default:g(()=>{var p;return[$(k(((p=e.mappingMap[a[e.prop]])==null?void 0:p.label)||a[e.prop]),1)]}),_:2},1032,["status","style"])):_("",!0)],64)):e.customRender?(s(),f("div",Ae,k(e.customRender(a,e,P)),1)):(s(),f(A,{key:2},[$(k(a[e.prop]),1)],64))]}):_("",!0)]),"filter-icon":g(()=>[h(r.$slots,"columnFilterIcon")]),_:2},1040,["label","prop"]))),128))]),_:2},[T(Y.value,i=>({name:i,fn:g(e=>[h(r.$slots,i,O(I(e||{})))])}))]),1040,["data"]),t.pagination?(s(),v(d(oe),u({key:0},t.pagination,{class:"pro-table-pagination"}),null,16)):_("",!0)],512)],2))}});export{_t as _};
