import{m as r}from"./vue-test-utils.esm-bundler.CXEWdIcj.js";import"./base.D1hT_OMg.js";/* empty css                          */import{c as f,d as b,b as y,a as w}from"./pro-el-components.es.D2RWaTV6.js";import{E as m}from"./el-input.BSgJ4dcH.js";import"./el-scrollbar.D7CKjqK8.js";import"./el-popper.DVtARkBh.js";import"./el-button.Ks_KV28J.js";import"./el-tag.eG6nSIS7.js";import{E as d}from"./el-select.DD745kxU.js";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang.CGioVs45.js";import{d as V,b as h,i as a,g as t}from"./vi.JYQecGiw.CwfDdTVD.js";import{a as v}from"./el-checkbox.vp91cqq1.js";import{P as u,ak as B,d as x,p as C,al as c}from"./framework.CCndWvNN.js";import"./el-popover.D2JF-F-v.js";import"./index.dVC2hAAQ.js";import"./types.BG7Bq31m.js";import"./index.B1pLMPru.js";import"./isSymbol.C7jn4vLP.js";import"./isObject.C3e4t58V.js";import"./index.l2C8AFQu.js";import"./icon.ZlYHZ6bL.js";import"./index.CQNcN25s.js";import"./el-dropdown.BOifsY6J.js";import"./index.DT7TJvLG.js";import"./aria.9SHySdGF.js";import"./index.DKuONPA3.js";import"./use-form-common-props.CD1z-U6Z.js";import"./index.BTWm3S8P.js";import"./castArray.nOJHwnz6.js";import"./refs.B6nQtqsB.js";import"./index.BESs4zff.js";import"./el-dropdown-item.l0sNRNKZ.js";import"./el-radio.DwTHR0gg.js";import"./event.BB_Ol6Sd.js";import"./index.CmxAuiKz.js";import"./index.BerH9hGA.js";import"./arrayPush.CXZMwWBu.js";import"./use-form-item.Br6EJJ4d.js";import"./error.Cq9Fpw4b.js";import"./isEqual.BFy4LUG1.js";import"./scroll.I75wR7Fj.js";import"./cloneDeep.CIaHHukw.js";import"./index.yFO58wlI.js";import"./index.DCylGgGu.js";import"./debounce.BwFge-ki.js";/* empty css                   */import"./el-overlay.BCS05DOt.js";import"./vnode.BEnbcVWi.js";import"./use-global-config.Cy85fLye.js";import"./el-progress.BRIRdYmT.js";import"./typescript.Bp3YSIOJ.js";import"./el-image-viewer.Dja78u7m.js";import"./el-col.CFugVZsV.js";import"./constants.0YSy3Igo.js";import"./el-row.CHA5sZ-H.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-menu-item._RQlHeQG.js";import"./dayjs.min.Ba62AOpW.js";import"./commonjsHelpers.BosuxZz1.js";import"./index.BxCfNOki.js";import"./index.CQyIUMkD.js";import"./index.BSzUxMWT.js";import"./index.r5W6hzzQ.js";import"./FieldWrapper.vue_vue_type_script_setup_true_lang.BAXXbrC5.js";import"./helper.tTdJ1HKL.js";import"./useFieldWatch.CLmNBKe8.js";import"./Wrapper.vue_vue_type_script_setup_true_lang.C-qljgpV.js";import"./vite-browser-external_commonjs-proxy.BC9WSf1a.js";V("proFormFields组件",()=>{let s;h(()=>{s=[{prop:"username",label:"用户名",type:"input",required:!0},{prop:"gender",label:"性别",type:"select",options:[{label:"男",value:"male"},{label:"女",value:"female"}]}]}),a("应该正确渲染表单项",()=>{const o=r(i,{props:{fields:s,modelValue:{}}});t(o.findAllComponents(m)).toHaveLength(1),t(o.findAllComponents(d)).toHaveLength(1)}),a("应该正确处理表单值的更新",async()=>{const o=r(i,{props:{fields:s,modelValue:{username:""}}});await o.findComponent(m).setValue("测试用户"),t(o.emitted("update:modelValue")).toBeTruthy(),t(o.emitted("update:modelValue")[0][0]).toEqual({username:"测试用户"})}),a("应该正确处理viewMode模式",async()=>{const o=r(i,{props:{fields:s,modelValue:{username:"测试用户",gender:"male"},viewMode:!0}});t(o.findComponent(m).exists()).toBe(!1),t(o.findComponent(d).exists()).toBe(!1),await u();const e=o.findAll(".el-form-item__content");t(e[0].text()).toBe("测试用户"),t(e[1].text()).toBe("男")}),a("应该正确处理表单项的显示/隐藏逻辑",async()=>{const e=r(i,{props:{fields:[{prop:"type",label:"类型",type:"select",options:[{label:"类型A",value:"A"},{label:"类型B",value:"B"}]},{prop:"extraField",label:"额外字段",type:"input",show:p=>p.type==="A"}],modelValue:{type:"B"}}});t(e.findAllComponents(m)).toHaveLength(0),await e.setProps({modelValue:{type:"A"}}),t(e.findAllComponents(m)).toHaveLength(1)}),a("应该正确处理日期类型的字段",async()=>{const e=r(i,{props:{fields:[{prop:"birthday",label:"生日",type:"datePicker"}],modelValue:{}}});t(e.findComponent(f).exists()).toBe(!0)}),a("应该正确处理数字输入类型",async()=>{const e=r(i,{props:{fields:[{prop:"age",label:"年龄",type:"number",min:0,max:120}],modelValue:{age:25}}}),p=e.findComponent(b);t(p.exists()).toBe(!0),await p.setValue(30),t(e.emitted("update:modelValue")[0][0]).toEqual({age:30})}),a("应该正确处理自定义验证规则",async()=>{const p=r(i,{props:{fields:[{prop:"email",label:"邮箱",type:"input",required:!0,rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入有效的邮箱地址"}]}],modelValue:{}}}).findComponent(y);t(p.exists()).toBe(!0),t(p.vm.rules).toBeTruthy()}),a("应该正确处理禁用状态",()=>{const p=r(i,{props:{fields:[{prop:"username",label:"用户名",type:"input",fieldProps:{disabled:!0}}],modelValue:{username:"测试用户"}}}).findComponent(m);t(p.vm.disabled).toBe(!0)}),a("应该正确处理多选框组",async()=>{const p=r(i,{props:{fields:[{prop:"hobbies",label:"兴趣爱好",type:"checkbox",options:[{label:"阅读",value:"reading"},{label:"运动",value:"sports"},{label:"音乐",value:"music"}]}],modelValue:{hobbies:["reading"]}}}).findComponent(v);t(p.exists()).toBe(!0)}),a("应该正确处理自定义Field",()=>{const o=B({template:'<div class="custom-field">自定义内容</div>'}),e=r(i,{props:{fields:[{prop:"custom",label:"自定义字段",type:"component",component:o}],modelValue:{}}});t(e.find(".custom-field").exists()).toBe(!0),t(e.find(".custom-field").text()).toBe("自定义内容")}),a("应该正确处理表单验证",async()=>{const o=x(l=>{const n=C(null);return()=>c(w,{ref:n},[c(i,{fields:l.fields||[],modelValue:l.modelValue||{}})])}),e=r(o,{props:{fields:s,modelValue:{}}}),p=e.vm.formRef;await u();try{await p.validate(),t(!0).toBe(!1)}catch(l){t(l).toBeTruthy()}await e.setProps({modelValue:{username:"测试用户"}}),await p.validate()}),a("应该正确处理值格式化",async()=>{var l;const e=r(i,{props:{fields:[{prop:"price",label:"价格",type:"input",formatChangedValue:n=>Number(n)}],modelValue:{price:100}}});await e.findComponent(m).setValue("200"),t((l=e.emitted("update:modelValue")[0])==null?void 0:l[0].price).toBe(200)}),a("应该正确处理栅格布局",()=>{const e=r(i,{props:{fields:s,modelValue:{},column:2}}).findAll(".el-col-12");t(e.length).toBeGreaterThan(0)})});
